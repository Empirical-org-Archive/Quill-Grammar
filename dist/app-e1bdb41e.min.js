!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({"./src/scripts/app/app.module.js":[function(require,module,exports){"use strict";angular.module("quill-grammar",[require("./core/core.module.js").name,require("./index/index.module.js").name,require("./cms/cms.module.js").name,require("./play/sentences/module.js").name,require("./play/proofreadings/module.js").name,require("./activities/module.js").name,require("./layout/layout.module.js").name,require("empirical-angular").name]).config(require("./app.config.js"))},{"./activities/module.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/module.js","./app.config.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/app.config.js","./cms/cms.module.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/cms/cms.module.js","./core/core.module.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/core/core.module.js","./index/index.module.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/index/index.module.js","./layout/layout.module.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/layout/layout.module.js","./play/proofreadings/module.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/proofreadings/module.js","./play/sentences/module.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/sentences/module.js","empirical-angular":"/home/will/Clients/Quill/Quill-Grammar/node_modules/empirical-angular/index.js"}],"/home/will/Clients/Quill/Quill-Grammar/.tmp/config.js":[function(require,module,exports){module.exports=angular.module("quill-grammar.config",[]).constant("environment","production").constant("firebaseUrl","https://quillgrammar.firebaseio.com/").constant("empiricalBaseURL","https://www.quill.org/api/v1").constant("portholeProxy","https://www.quill.org/porthole_proxy").constant("firebaseApp","quillgrammar").constant("oauthClientId","2e8c49f66d9ea0ccbd71ea568c75eef96782e6a7510ebab7c537f3c6d563f6f2")},{}],"/home/will/Clients/Quill/Quill-Grammar/.tmp/templates.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.templates",[]).run(["$templateCache",function($templateCache){$templateCache.put("index.html",'<!DOCTYPE html><html ng-app="quill-grammar" ng-strict-di><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title></title><script>window.onload = function() { Porthole.WindowProxyDispatcher.start(); };</script><script src="//use.typekit.net/plr0bzn.js"></script>\n<script>try{Typekit.load();}catch(e){}</script>\n<!-- start Mixpanel --><script type="text/javascript">(function(f,b){if(!b.__SV){var a,e,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");\nfor(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";e=f.getElementsByTagName("script")[0];e.parentNode.insertBefore(a,e)}})(document,window.mixpanel||[]);\nmixpanel.init("e73f42bb313901840b5871ddc775a72b");</script><!-- end Mixpanel -->\n<script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(t,e,n){function r(n){if(!e[n]){var o=e[n]={exports:{}};t[n][0].call(o.exports,function(e){var o=t[n][1][e];return r(o?o:e)},o,o.exports)}return e[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<n.length;o++)r(n[o]);return r}({QJf3ax:[function(t,e){function n(t){function e(e,n,a){t&&t(e,n,a),a||(a={});for(var c=s(e),f=c.length,u=i(a,o,r),d=0;f>d;d++)c[d].apply(u,n);return u}function a(t,e){f[t]=s(t).concat(e)}function s(t){return f[t]||[]}function c(){return n(e)}var f={};return{on:a,emit:e,create:c,listeners:s,_events:f}}function r(){return{}}var o="nr@context",i=t("gos");e.exports=n()},{gos:"7eSDFh"}],ee:[function(t,e){e.exports=t("QJf3ax")},{}],3:[function(t){function e(t){try{i.console&&console.log(t)}catch(e){}}var n,r=t("ee"),o=t(1),i={};try{n=localStorage.getItem("__nr_flags").split(","),console&&"function"==typeof console.log&&(i.console=!0,-1!==n.indexOf("dev")&&(i.dev=!0),-1!==n.indexOf("nr_dev")&&(i.nrDev=!0))}catch(a){}i.nrDev&&r.on("internal-error",function(t){e(t.stack)}),i.dev&&r.on("fn-err",function(t,n,r){e(r.stack)}),i.dev&&(e("NR AGENT IN DEVELOPMENT MODE"),e("flags: "+o(i,function(t){return t}).join(", ")))},{1:22,ee:"QJf3ax"}],4:[function(t){function e(t,e,n,i,s){try{c?c-=1:r("err",[s||new UncaughtException(t,e,n)])}catch(f){try{r("ierr",[f,(new Date).getTime(),!0])}catch(u){}}return"function"==typeof a?a.apply(this,o(arguments)):!1}function UncaughtException(t,e,n){this.message=t||"Uncaught error with no additional information",this.sourceURL=e,this.line=n}function n(t){r("err",[t,(new Date).getTime()])}var r=t("handle"),o=t(6),i=t("ee"),a=window.onerror,s=!1,c=0;t("loader").features.err=!0,t(5),window.onerror=e;try{throw new Error}catch(f){"stack"in f&&(t(1),t(2),"addEventListener"in window&&t(3),window.XMLHttpRequest&&XMLHttpRequest.prototype&&XMLHttpRequest.prototype.addEventListener&&window.XMLHttpRequest&&XMLHttpRequest.prototype&&XMLHttpRequest.prototype.addEventListener&&!/CriOS/.test(navigator.userAgent)&&t(4),s=!0)}i.on("fn-start",function(){s&&(c+=1)}),i.on("fn-err",function(t,e,r){s&&(this.thrown=!0,n(r))}),i.on("fn-end",function(){s&&!this.thrown&&c>0&&(c-=1)}),i.on("internal-error",function(t){r("ierr",[t,(new Date).getTime(),!0])})},{1:9,2:8,3:6,4:10,5:3,6:23,ee:"QJf3ax",handle:"D5DuLP",loader:"G9z0Bl"}],5:[function(t){function e(){}if(window.performance&&window.performance.timing&&window.performance.getEntriesByType){var n=t("ee"),r=t("handle"),o=t(1),i=t(2);t("loader").features.stn=!0,t(3),n.on("fn-start",function(t){var e=t[0];e instanceof Event&&(this.bstStart=Date.now())}),n.on("fn-end",function(t,e){var n=t[0];n instanceof Event&&r("bst",[n,e,this.bstStart,Date.now()])}),o.on("fn-start",function(t,e,n){this.bstStart=Date.now(),this.bstType=n}),o.on("fn-end",function(t,e){r("bstTimer",[e,this.bstStart,Date.now(),this.bstType])}),i.on("fn-start",function(){this.bstStart=Date.now()}),i.on("fn-end",function(t,e){r("bstTimer",[e,this.bstStart,Date.now(),"requestAnimationFrame"])}),n.on("pushState-start",function(){this.time=Date.now(),this.startPath=location.pathname+location.hash}),n.on("pushState-end",function(){r("bstHist",[location.pathname+location.hash,this.startPath,this.time])}),"addEventListener"in window.performance&&(window.performance.addEventListener("webkitresourcetimingbufferfull",function(){r("bstResource",[window.performance.getEntriesByType("resource")]),window.performance.webkitClearResourceTimings()},!1),window.performance.addEventListener("resourcetimingbufferfull",function(){r("bstResource",[window.performance.getEntriesByType("resource")]),window.performance.clearResourceTimings()},!1)),document.addEventListener("scroll",e,!1),document.addEventListener("keypress",e,!1),document.addEventListener("click",e,!1)}},{1:9,2:8,3:7,ee:"QJf3ax",handle:"D5DuLP",loader:"G9z0Bl"}],6:[function(t,e){function n(t){i.inPlace(t,["addEventListener","removeEventListener"],"-",r)}function r(t){return t[1]}var o=(t(1),t("ee").create()),i=t(2)(o),a=t("gos");if(e.exports=o,n(window),"getPrototypeOf"in Object){for(var s=document;s&&!s.hasOwnProperty("addEventListener");)s=Object.getPrototypeOf(s);s&&n(s);for(var c=XMLHttpRequest.prototype;c&&!c.hasOwnProperty("addEventListener");)c=Object.getPrototypeOf(c);c&&n(c)}else XMLHttpRequest.prototype.hasOwnProperty("addEventListener")&&n(XMLHttpRequest.prototype);o.on("addEventListener-start",function(t){if(t[1]){var e=t[1];"function"==typeof e?this.wrapped=t[1]=a(e,"nr@wrapped",function(){return i(e,"fn-",null,e.name||"anonymous")}):"function"==typeof e.handleEvent&&i.inPlace(e,["handleEvent"],"fn-")}}),o.on("removeEventListener-start",function(t){var e=this.wrapped;e&&(t[1]=e)})},{1:23,2:24,ee:"QJf3ax",gos:"7eSDFh"}],7:[function(t,e){var n=(t(2),t("ee").create()),r=t(1)(n);e.exports=n,r.inPlace(window.history,["pushState"],"-")},{1:24,2:23,ee:"QJf3ax"}],8:[function(t,e){var n=(t(2),t("ee").create()),r=t(1)(n);e.exports=n,r.inPlace(window,["requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame"],"raf-"),n.on("raf-start",function(t){t[0]=r(t[0],"fn-")})},{1:24,2:23,ee:"QJf3ax"}],9:[function(t,e){function n(t,e,n){t[0]=o(t[0],"fn-",null,n)}var r=(t(2),t("ee").create()),o=t(1)(r);e.exports=r,o.inPlace(window,["setTimeout","setInterval","setImmediate"],"setTimer-"),r.on("setTimer-start",n)},{1:24,2:23,ee:"QJf3ax"}],10:[function(t,e){function n(){f.inPlace(this,p,"fn-")}function r(t,e){f.inPlace(e,["onreadystatechange"],"fn-")}function o(t,e){return e}function i(t,e){for(var n in t)e[n]=t[n];return e}var a=t("ee").create(),s=t(1),c=t(2),f=c(a),u=c(s),d=window.XMLHttpRequest,p=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"];e.exports=a,window.XMLHttpRequest=function(t){var e=new d(t);try{a.emit("new-xhr",[],e),u.inPlace(e,["addEventListener","removeEventListener"],"-",o),e.addEventListener("readystatechange",n,!1)}catch(r){try{a.emit("internal-error",[r])}catch(i){}}return e},i(d,XMLHttpRequest),XMLHttpRequest.prototype=d.prototype,f.inPlace(XMLHttpRequest.prototype,["open","send"],"-xhr-",o),a.on("send-xhr-start",r),a.on("open-xhr-start",r)},{1:6,2:24,ee:"QJf3ax"}],11:[function(t){function e(t){var e=this.params,r=this.metrics;if(!this.ended){this.ended=!0;for(var i=0;c>i;i++)t.removeEventListener(s[i],this.listener,!1);if(!e.aborted){if(r.duration=(new Date).getTime()-this.startTime,4===t.readyState){e.status=t.status;var a=t.responseType,f="arraybuffer"===a||"blob"===a||"json"===a?t.response:t.responseText,u=n(f);if(u&&(r.rxSize=u),this.sameOrigin){var d=t.getResponseHeader("X-NewRelic-App-Data");d&&(e.cat=d.split(", ").pop())}}else e.status=0;r.cbTime=this.cbTime,o("xhr",[e,r,this.startTime])}}}function n(t){if("string"==typeof t&&t.length)return t.length;if("object"!=typeof t)return void 0;if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&t.byteLength)return t.byteLength;if("undefined"!=typeof Blob&&t instanceof Blob&&t.size)return t.size;if("undefined"!=typeof FormData&&t instanceof FormData)return void 0;try{return JSON.stringify(t).length}catch(e){return void 0}}function r(t,e){var n=i(e),r=t.params;r.host=n.hostname+":"+n.port,r.pathname=n.pathname,t.sameOrigin=n.sameOrigin}if(window.XMLHttpRequest&&XMLHttpRequest.prototype&&XMLHttpRequest.prototype.addEventListener&&!/CriOS/.test(navigator.userAgent)){t("loader").features.xhr=!0;var o=t("handle"),i=t(2),a=t("ee"),s=["load","error","abort","timeout"],c=s.length,f=t(1);t(4),t(3),a.on("new-xhr",function(){this.totalCbs=0,this.called=0,this.cbTime=0,this.end=e,this.ended=!1,this.xhrGuids={}}),a.on("open-xhr-start",function(t){this.params={method:t[0]},r(this,t[1]),this.metrics={}}),a.on("open-xhr-end",function(t,e){"loader_config"in NREUM&&"xpid"in NREUM.loader_config&&this.sameOrigin&&e.setRequestHeader("X-NewRelic-ID",NREUM.loader_config.xpid)}),a.on("send-xhr-start",function(t,e){var r=this.metrics,o=t[0],i=this;if(r&&o){var f=n(o);f&&(r.txSize=f)}this.startTime=(new Date).getTime(),this.listener=function(t){try{"abort"===t.type&&(i.params.aborted=!0),("load"!==t.type||i.called===i.totalCbs&&(i.onloadCalled||"function"!=typeof e.onload))&&i.end(e)}catch(n){try{a.emit("internal-error",[n])}catch(r){}}};for(var u=0;c>u;u++)e.addEventListener(s[u],this.listener,!1)}),a.on("xhr-cb-time",function(t,e,n){this.cbTime+=t,e?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof n.onload||this.end(n)}),a.on("xhr-load-added",function(t,e){var n=""+f(t)+!!e;this.xhrGuids&&!this.xhrGuids[n]&&(this.xhrGuids[n]=!0,this.totalCbs+=1)}),a.on("xhr-load-removed",function(t,e){var n=""+f(t)+!!e;this.xhrGuids&&this.xhrGuids[n]&&(delete this.xhrGuids[n],this.totalCbs-=1)}),a.on("addEventListener-end",function(t,e){e instanceof XMLHttpRequest&&"load"===t[0]&&a.emit("xhr-load-added",[t[1],t[2]],e)}),a.on("removeEventListener-end",function(t,e){e instanceof XMLHttpRequest&&"load"===t[0]&&a.emit("xhr-load-removed",[t[1],t[2]],e)}),a.on("fn-start",function(t,e,n){e instanceof XMLHttpRequest&&("onload"===n&&(this.onload=!0),("load"===(t[0]&&t[0].type)||this.onload)&&(this.xhrCbStart=(new Date).getTime()))}),a.on("fn-end",function(t,e){this.xhrCbStart&&a.emit("xhr-cb-time",[(new Date).getTime()-this.xhrCbStart,this.onload,e],e)})}},{1:"XL7HBI",2:12,3:10,4:6,ee:"QJf3ax",handle:"D5DuLP",loader:"G9z0Bl"}],12:[function(t,e){e.exports=function(t){var e=document.createElement("a"),n=window.location,r={};e.href=t,r.port=e.port;var o=e.href.split("://");return!r.port&&o[1]&&(r.port=o[1].split("/")[0].split("@").pop().split(":")[1]),r.port&&"0"!==r.port||(r.port="https"===o[0]?"443":"80"),r.hostname=e.hostname||n.hostname,r.pathname=e.pathname,r.protocol=o[0],"/"!==r.pathname.charAt(0)&&(r.pathname="/"+r.pathname),r.sameOrigin=!e.hostname||e.hostname===document.domain&&e.port===n.port&&e.protocol===n.protocol,r}},{}],13:[function(t,e){function n(t){return function(){r(t,[(new Date).getTime()].concat(i(arguments)))}}var r=t("handle"),o=t(1),i=t(2);"undefined"==typeof window.newrelic&&(newrelic=window.NREUM);var a=["setPageViewName","addPageAction","setCustomAttribute","finished","addToTrace","inlineHit","noticeError"];o(a,function(t,e){window.NREUM[e]=n("api-"+e)}),e.exports=window.NREUM},{1:22,2:23,handle:"D5DuLP"}],"7eSDFh":[function(t,e){function n(t,e,n){if(r.call(t,e))return t[e];var o=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,e,{value:o,writable:!0,enumerable:!1}),o}catch(i){}return t[e]=o,o}var r=Object.prototype.hasOwnProperty;e.exports=n},{}],gos:[function(t,e){e.exports=t("7eSDFh")},{}],handle:[function(t,e){e.exports=t("D5DuLP")},{}],D5DuLP:[function(t,e){function n(t,e,n){return r.listeners(t).length?r.emit(t,e,n):(o[t]||(o[t]=[]),void o[t].push(e))}var r=t("ee").create(),o={};e.exports=n,n.ee=r,r.q=o},{ee:"QJf3ax"}],id:[function(t,e){e.exports=t("XL7HBI")},{}],XL7HBI:[function(t,e){function n(t){var e=typeof t;return!t||"object"!==e&&"function"!==e?-1:t===window?0:i(t,o,function(){return r++})}var r=1,o="nr@id",i=t("gos");e.exports=n},{gos:"7eSDFh"}],G9z0Bl:[function(t,e){function n(){var t=p.info=NREUM.info,e=f.getElementsByTagName("script")[0];if(t&&t.licenseKey&&t.applicationID&&e){s(d,function(e,n){e in t||(t[e]=n)});var n="https"===u.split(":")[0]||t.sslForHttp;p.proto=n?"https://":"http://",a("mark",["onload",i()]);var r=f.createElement("script");r.src=p.proto+t.agent,e.parentNode.insertBefore(r,e)}}function r(){"complete"===f.readyState&&o()}function o(){a("mark",["domContent",i()])}function i(){return(new Date).getTime()}var a=t("handle"),s=t(1),c=(t(2),window),f=c.document,u=(""+location).split("?")[0],d={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-632.min.js"},p=e.exports={offset:i(),origin:u,features:{}};f.addEventListener?(f.addEventListener("DOMContentLoaded",o,!1),c.addEventListener("load",n,!1)):(f.attachEvent("onreadystatechange",r),c.attachEvent("onload",n)),a("mark",["firstbyte",i()])},{1:22,2:13,handle:"D5DuLP"}],loader:[function(t,e){e.exports=t("G9z0Bl")},{}],22:[function(t,e){function n(t,e){var n=[],o="",i=0;for(o in t)r.call(t,o)&&(n[i]=e(o,t[o]),i+=1);return n}var r=Object.prototype.hasOwnProperty;e.exports=n},{}],23:[function(t,e){function n(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var r=-1,o=n-e||0,i=Array(0>o?0:o);++r<o;)i[r]=t[e+r];return i}e.exports=n},{}],24:[function(t,e){function n(t){return!(t&&"function"==typeof t&&t.apply&&!t[i])}var r=t("ee"),o=t(1),i="nr@wrapper",a=Object.prototype.hasOwnProperty;e.exports=function(t){function e(t,e,r,a){function nrWrapper(){var n,i,s,f;try{i=this,n=o(arguments),s=r&&r(n,i)||{}}catch(d){u([d,"",[n,i,a],s])}c(e+"start",[n,i,a],s);try{return f=t.apply(i,n)}catch(p){throw c(e+"err",[n,i,p],s),p}finally{c(e+"end",[n,i,f],s)}}return n(t)?t:(e||(e=""),nrWrapper[i]=!0,f(t,nrWrapper),nrWrapper)}function s(t,r,o,i){o||(o="");var a,s,c,f="-"===o.charAt(0);for(c=0;c<r.length;c++)s=r[c],a=t[s],n(a)||(t[s]=e(a,f?s+o:o,i,s))}function c(e,n,r){try{t.emit(e,n,r)}catch(o){u([o,e,n,r])}}function f(t,e){if(Object.defineProperty&&Object.keys)try{var n=Object.keys(t);return n.forEach(function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){return t[n]=e,e}})}),e}catch(r){u([r])}for(var o in t)a.call(t,o)&&(e[o]=t[o]);return e}function u(e){try{t.emit("internal-error",e)}catch(n){}}return t||(t=r),e.inPlace=s,e.flag=i,e}},{1:23,ee:"QJf3ax"}]},{},["G9z0Bl",4,11,5]);\n;NREUM.info={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",licenseKey:"f56b3f88be",applicationID:"6139670",sa:1,agent:"js-agent.newrelic.com/nr-632.min.js"}\n</script><base href="/"></head><body><ui-view></ui-view><script type="text/javascript">\nsetTimeout(function(){var a=document.createElement("script");\nvar b=document.getElementsByTagName("script")[0];\na.src=document.location.protocol+"//script.crazyegg.com/pages/scripts/0031/6377.js?"+Math.floor(new Date().getTime()/3600000);\na.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);\n</script></body></html>'),$templateCache.put("cms.html",'<div class="grammar-cms"><grammar-cms-categories-new></grammar-cms-categories-new><grammar-cms-categories-list></grammar-cms-categories-list></div>'),$templateCache.put("layout.html","<ui-view></ui-view>"),$templateCache.put("progress-bar.html",'<div class="activity-progress-bar">\n  <p>{{title}} {{progressString}}</p>\n  <div class="progress-bar-indication">\n    <span class="meter" ng-style="progressBarPercentage"></span>\n  </div>\n</div>\n'),$templateCache.put("activities.html",'<h2>Activities</h2>\n<a ui-sref="sentences.list()">Sentence Writing</a>\n<a ui-sref="proofreadings.list()">Passage Proofreadings</a>\n<ui-view></ui-view>\n'),$templateCache.put("index.html",'<button ng-show="showNextQuestion" ng-click="nextQuestion()">Next Question</button>\n<grammar-rule-question rule-question="currentRuleQuestion">\n</grammar-rule-question>\n<button ng-show="showPreviousQuestion" ng-click="previousQuestion()">Previous Question</button>\n'),$templateCache.put("categories.list.html",'<ul>\n  <li ng-repeat="category in categories">\n    <grammar-cms-category category="category"></grammar-cms-category>\n  <li>\n</ul>\n'),$templateCache.put("categories.new.html",'<button ng-click=\'toggleCategoryModal()\'>New Category</button>\n<grammar-cms-modal-dialog\n  show=\'showNewCategoryModal\'\n  action=\'saveCategory\'>\n  <form validate>\n    <label for="category">Category Title</label>\n    <input type="text" name="category" placeholder="Category Name" ng-model="category.title" />\n    <input type="submit" ng-click="$parent.doAction(category)" value="Add Category" />\n  </form>\n</grammar-cms-modal-dialog>\n'),$templateCache.put("category.edit.html",'<ul>\n  <li><img src="assets/images/newrule.png" ng-click=\'newRule()\' alt="Add Rule" title="Add Rule"/></li>\n  <li><img src="assets/images/delete.png" ng-click="showDeleteCategory()" alt="Delete Category" title="Delete Category"/></li>\n  <li><img src="assets/images/edit.png" ng-click="editCategory(category)" alt="Edit Category" title="Edit Category"/></li>\n</ul>\n\n<grammar-cms-modal-dialog\n  show=\'showNewRuleModal\'\n  action=\'saveRule\'>\n  <form validate ng-submit="$parent.doAction(category, rule)">\n    <p>New Rule for {{category.title}}</p>\n    <input type="text" name="rule" placeholder="Rule Name" ng-model="rule.title" required/>\n    <input type="text" name="description" placeholder="Rule Description"\n      ng-model="rule.description" required/>\n    <input type="text" name="classification" placeholder="Rule Classification"\n      ng-model="rule.classification" required/>\n    <input type="submit" value="Add Rule" />\n  </form>\n</grammar-cms-modal-dialog>\n\n<grammar-cms-delete-modal-dialog show=\'showDeleteCategoryModal\' on-delete="deleteCategory" item="category">\n  <p>Deleting this will delete all rules and practice questions in this category.</p>\n</grammar-cms-delete-modal-dialog>\n'),$templateCache.put("category.show.html",'<div class="grammar-cms-section">\n  <div class="grammar-cms-heading">\n    <h2>{{category.title}}</h2>\n    <button\n      ng-show="!category.resolvedRules"\n      ng-click="showRules(category)"\n    >Show Rules</button>\n  <p>{{category.error}}</p>\n  </div>\n  <grammar-cms-category-panel\n    category="category"\n    class="grammar-cms-panel">\n  </grammar-cms-category-panel>\n</div>\n<div ng-show="category.resolvedRules">\n  <grammar-cms-rule\n    ng-show="rule"\n    rule="rule"\n    ng-repeat="rule in category.resolvedRules">\n  </grammar-cms-rule>\n  <button ng-click="hideRules(category)">Hide Rules</button\n</div>\n'),$templateCache.put("deleteModal.html",'<div class="modal" ng-show="show">\n  <input class="modal-state" type="checkbox" ng-checked="show"/>\n  <div class="modal-window">\n    <div class="modal-inner">\n      <label class="modal-close" ng-click="hideModal()"></label>\n      <p>Delete {{item.title}}?<p>\n      <div ng-transclude></div>\n      <button ng-click="_onDelete(item)">Delete</button>\n      <p class="error" ng-show="error">{{error}}</p>\n    </div>\n  </div>\n</div>\n'),$templateCache.put("modal.html",'<div class="modal" ng-show="show">\n  <input class="modal-state" type="checkbox" ng-checked="show"/>\n  <div class="modal-window">\n    <div class="modal-inner">\n      <label class="modal-close" ng-click="hideModal()"></label>\n      <div ng-transclude></div>\n    </div>\n  </div>\n</div>\n'),$templateCache.put("question.edit.html",'<ul>\n  <li><span class="spacer"></span></li>\n  <li><img src="assets/images/delete.png" ng-click="showDeleteRuleQuestion()" alt="Delete Rule Question" title="Delete Rule Question"/></li>\n  <li><img src="assets/images/edit.png" ng-click="editRuleQuestion(question)" alt="Edit Rule Question"/title="Edit Rule Question"></li>\n</ul>\n\n<grammar-cms-delete-modal-dialog show=\'showDeleteRuleQuestionModal\' on-delete="deleteRuleQuestion" item="question">\n  <p>{{question.prompt}}</p>\n</grammar-cms-delete-modal-dialog>\n'),$templateCache.put("question.show.html",'<div class="grammar-cms-section">\n  <div class="grammar-cms-heading">\n    <p>{{question.prompt}}</p>\n  </div>\n  <grammar-cms-rule-question-panel class="grammar-cms-panel" question="question"></grammar-cms-rule-question-panel>\n</div>\n'),$templateCache.put("rule.edit.html",'<ul>\n  <li><img src="assets/images/newrulequestion.png" ng-click=\'showRuleQuestionModal()\' alt="Add Rule Question" title="Add Rule Question"/></li>\n  <li><img src="assets/images/delete.png" ng-click="showDeleteRule()" alt="Delete Rule" title="Delete Rule"/></li>\n  <li><img src="assets/images/edit.png" ng-click="editRule(rule)" alt="Edit Rule" title="Edit Rule"/></li>\n</ul>\n\n<grammar-cms-modal-dialog\n  show=\'showNewRuleQuestionModal\'\n  action=\'saveRuleQuestion\'>\n  <form validate ng-submit=\'$parent.doAction(rule, question)\'>\n    <p>Adding rule question for rule "{{rule.title}}"</p>\n    <input required type="text" name="prompt" placeholder="Prompt"\n    ng-model="question.prompt" />\n    <input type="text" name="hint" placeholder="Hint"\n    ng-model="question.hint" />\n    <p><b>Body</b></p>\n    <ul>\n      <li style="display: block;" ng-repeat="b in question.body">\n        <input type="text" ng-model="b" />\n      </li>\n    </ul>\n    <input type="text" name="body" placeholder="Correct Response"\n    ng-model="question.tempB" />\n    <button type="button" ng-click="addAnswerToBody(question)">\n      Add Correct Response\n    </button>\n    <input required type="text" name="instructions" placeholder="Instructions"\n    ng-model="question.instructions"/>\n    <input type="submit" value="Add Practice Question" />\n  </form>\n</grammar-cms-modal-dialog>\n\n<grammar-cms-delete-modal-dialog show=\'showDeleteRuleModal\' on-delete="deleteRule" item="rule">\n  <p>This will delete all practice questions for this rule.</p>\n</grammar-cms-delete-modal-dialog>\n'),$templateCache.put("rule.show.html",'<div class="grammar-cms-section">\n  <div class="grammar-cms-heading">\n    <h5>{{rule.title}} - {{rule.ruleNumber}}</h5>\n  </div>\n  <grammar-cms-rule-panel class="grammar-cms-panel"\n  rule="rule"></grammar-cms-rule-panel>\n</div>\n\n<ul>\n  <li ng-repeat="question in rule.resolvedRuleQuestions">\n    <grammar-cms-rule-question question="question"></grammar-cms-rule-question>\n  </li>\n</ul>\n'),$templateCache.put("proofreadings.list.html",'<h2>Passage Proofreadings</h2>\n<ul ng-repeat="set in proofreadings">\n  <ul>\n    <li><a ui-sref="play-pf({uid: set.$id})"><h3>{{set.title}}</h3></a></li>\n    <li><a ui-sref="proofreadings.edit({id: set.$id})">edit</a>\n  </ul>\n</ul>\n\n<a ui-sref="proofreadings.new()">new</a>\n'),$templateCache.put("sentences.edit.html",'<label for="sentence.new">Practice Question</label>\n<input type="text" name="sentence.new" placeholder="Name"\n  ng-model="editSentence.title" required/>\n<input type="text" name="sentence.description" placeholder="Description"\nng-model="editSentence.description" required/>\n<select ng-options="flag.$value for flag in flags" ng-model="editSentence.flag"\n  placeholder="Flag" required></select>\n<select ng-options="cat.title for cat in availableCategories"\n  ng-model="editSentence.category" required></select>\n<select ng-options="(rule.ruleNumber + \'. \' + rule.title) for rule in availableRules" ng-model="tempRule"></select>\n\n<button ng-click="addRule(editSentence, tempRule)">Add Rule</button>\n\n<ul ng-repeat="rule in editSentence.rules">\n  <li>\n    <h4>{{rule.ruleNumber}}. {{rule.title}}</h4>\n    <p>{{rule.description}}</p>\n    <input type="text"\n       placeholder="Number of Questions from this Rule"\n       ng-model="rule.quantity"/>\n    <button ng-click="removeRule(editSentence, rule)">X Remove</button>\n  </li>\n</ul>\n<div class="error" ng-show="error">\n  <p>{{error}}</p>\n</div>\n\n<button\n    ng-click="submitSentence(\'^.list\', editSentence, true)"\n    ng-show="editSentence.rules.length > 0">\n  Update\n</button>\n'),$templateCache.put("sentences.list.html",'<h2>Sentence Writing</h2>\n<ul ng-repeat="set in sentences">\n  <ul>\n    <li><a ui-sref="play-sw({uid: set.$id})"><h3>{{set.title}}</h3></a></li>\n    <li><a ui-sref="sentences.edit({id: set.$id})">edit</a>\n  </ul>\n</ul>\n\n<a ui-sref="sentences.new.details()">new</a>\n'),$templateCache.put("sentences.new.details.html",'<form validate ng-submit="nextStep()">\n  <label for="sentence.new">Practice Question</label>\n  <input type="text" name="sentence.new" placeholder="Name"\n    ng-model="newSentence.title" required/>\n  <input type="text" name="sentence.description" placeholder="Description"\n  ng-model="newSentence.description" required/>\n  <select ng-options="flag.$value for flag in flags" ng-model="newSentence.flag"\n    placeholder="Flag" required></select>\n  <select ng-options="cat.title for cat in availableCategories"\n    ng-model="newSentence.category" required></select>\n  <button type="submit">Next</button>\n</form>\n'),$templateCache.put("sentences.new.html","<h3>New Sentence Writing</h3>\n<div ui-view></div>\n"),$templateCache.put("sentences.new.questions.html",'<select ng-options="(rule.ruleNumber + \'. \' + rule.title) for rule in availableRules" ng-model="tempRule"></select>\n\n<button ng-click="addRule(newSentence, tempRule)">Add Rule</button>\n\n<ul ng-repeat="rule in newSentence.rules">\n  <li>\n    <h4>{{rule.ruleNumber}}. {{rule.title}}</h4>\n    <p>{{rule.description}}</p>\n    <input type="text"\n       placeholder="Number of Questions from this Rule"\n       ng-model="rule.quantity"/>\n    <button ng-click="removeRule(newSentence, rule)">X Remove</button>\n  </li>\n</ul>\n<div class="error" ng-show="error">\n  <p>{{error}}</p>\n</div>\n\n<button\n    ng-click="submitSentence(\'^.^.list\', newSentence)"\n    ng-show="newSentence.rules.length > 0">\n  Submit\n</button>\n'),$templateCache.put("passage.html",'<div class="passage">\n  <div ng-class="{\'word\':true, \'error-tooltip-item\': !isBr(word.responseText)}" ng-repeat="(index, word) in passage" id="error-tooltip-scroll-{{index}}">\n    <p ng-bind-html="space" ng-show="isBr(word.responseText)" id="break-binding-point-{{index}}"></p>\n    <input\n      autofocus="$first"\n      ng-show="!isBr(word.responseText)"\n      type="text"\n      ng-class="{focused: word.isFocused, incorrectError: hasIncorrectError(word), notNecessaryError: hasNotNecessaryError(word), changed: word.text !== word.responseText, correct: hasCorrect(word), underlined: needsUnderlining(word), tooltipped: word.tooltip.style}"\n      ng-readonly="passage.submitted"\n      ng-focus="word.isFocused = true"\n      ng-change="onInputChange(word)"\n      ng-blur="word.isFocused = false"\n      ng-size="{{word.responseText.length}}"\n      ng-trim="false"\n      ng-model="word.responseText">\n    </input>\n    <div ng-class="getErrorTooltipClass(index)" ng-show="!isBr(word.responseText) && hasErrorToShow(word)"\n      ng-style="word.tooltip.style">\n      <div ng-class="{incorrectError: hasIncorrectError(word), notNecessaryError: hasNotNecessaryError(word), correct: hasCorrect(word)}">\n        <div ng-class="getErrorTooltipTopClass(answerImageName(word.type))">\n          <div class="img-div">\n            <img ng-src="/assets/images/{{answerImageName(word.type)}}_icon.png" alt="{{word.type}}"></img>\n          </div>\n          <h4>{{word.type}}</h4>\n          <p class="counter">{{errorCounter(word)}}</p>\n        </div>\n        <div class="bottom-panel">\n          <h4>Correct Edit:</h4>\n          <p ng-show="word.plus">{{word.plus}}</p>\n          <p ng-show="!word.plus">{{word.text}}</p>\n          <h4 ng-show="!hasNotNecessaryError(word)">Grammatical Concept:</h4>\n          <p ng-show="!hasNotNecessaryError(word)">{{getGrammaticalConceptForWord(word)}}</p>\n          <button ng-click="word.nextAction.fn()">{{word.nextAction.title}} ➞</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'),$templateCache.put("pf-heading.html",'<div class="quill-grammar-pf-heading">\n  <h1 ng-show="!pf.image">{{pf.title}}</h1>\n  <div class="header-image" ng-show="pf.image">\n    <img ng-src="/assets/images/{{pf.image}}" alt="pf.title"></img>\n    <p>{{pf.title}}</p>\n  </div>\n  <div class="instructions">\n    <img src="/assets/images/information_icon.png" alt="information"></img>\n    <p ng-bind-html="pf.instructions | trustedHtml"></p>\n  </div>\n  <activity-progress-bar max="getNumErrors()" current="numChanges" title="\'Edits Made:\'"></activity-progress-bar>\n</div>\n'),$templateCache.put("pf-submit-panel.html",'<div ng-class="{\'passage-submit-panel\': true, \'passage-submitted\': pf.passage.submitted}" id="last-chance-tooltip-breakpoint-at-panel">\n  <div class="passage-message">\n    {{pf.message}}\n  </div>\n  <button ng-show="!pf.passage.submitted" ng-class="{\'no-message\': !pf.message}" ng-click="submitPassage()">Check Work</button>\n</div>\n'),
$templateCache.put("proofreadings.play.html",'<div ng-class="{proofreading:true}" ng-show="pf">\n  <quill-grammar-pf-heading pf="pf" num-changes="numChanges"></quill-grammar-pf-heading>\n  <quill-grammar-passage passage="pf.passage" num-changes="numChanges"></quill-grammar-passage>\n  <quill-grammar-passage-submit-panel></quill-grammar-passage-submit-panel>\n\n  <div class="proofreading-modal" ng-show="pf.modal.show">\n    <input class="modal-state" type="checkbox" ng-checked="pf.modal.show"/>\n    <div class="modal-window">\n      <div class="modal-inner">\n        <h2>{{pf.modal.title}}</h2>\n        <p>{{pf.modal.message}}</p>\n        <button ng-click="pf.modal.buttonClick()">{{pf.modal.buttonMessage}}</button>\n      </div>\n    </div>\n  </div>\n\n</div>\n'),$templateCache.put("sentences.concept-overview.html",'<div class="sentence-tooltip-item">\n  <p class="concept-overview">Concept Overview</p>\n  <div class="sentence-tooltip">\n    <h2>Concept Overview</h2>\n    <p ng-bind-html="formatDescription(currentRule.description) | trustedHtml"></p>\n  </div>\n</div>\n'),$templateCache.put("sentences.play.html",'<div ng-class="{\'sentence-writing\': true}" ng-show="swSet.length">\n  <div class="passage-heading" ng-show="passageTitle && passageImageUrl">\n    <img ng-src="/assets/images/{{passageImageUrl}}" alt="passageTitle"></img>\n    <p>{{passageTitle}}</p>\n  </div>\n  <div class="sentence-writing-heading">\n    <div class="left">\n      <h2>{{currentRule.title}}</h2>\n      <sentence-writing-concept-overview></sentence-writing-concept-overview>\n      <sentence-writing-instructions current-rule="currentRule"></sentence-writing-instructions>\n    </div>\n    <div class="right">\n      <activity-progress-bar title="\'Sentence Completed:\'" max="questions.length" current="number"></activity-progress-bar>\n    </div>\n  </div>\n  <grammar-rule-question rule-question="currentRuleQuestion">\n    <sentence-writing-submit-panel></sentence-writing-submit-panel>\n  </grammar-rule-question>\n</div>\n'),$templateCache.put("sentences.results.html",""),$templateCache.put("sentences.submit-panel.html",'<button ng-show="showNextQuestion" ng-click="nextQuestion()">Next Problem</button>\n'),$templateCache.put("ruleQuestion.html",'<div class="ruleQuestion">\n  <div class="information">\n    <img src="/assets/images/information_icon.png" alt="information_icon"/>\n    <p ng-bind-html="ruleQuestion.resolvedInstructions | trustedHtml"></p>\n  </div>\n  <p class="prompt" ng-bind-html="ruleQuestion.prompt | formatPrompt | trustedHtml"></p>\n  <textarea class="student-input" type="text" ng-model="ruleQuestion.response" ng-paste="capturePasteEvent($event)"></textarea>\n  <div class="rule-question-sentence-bar" ng-class="ruleQuestionClass">\n    <div class="message-panel">\n      <img ng-src="/assets/images/{{ruleQuestionClass}}_icon.png" alt="ruleQuestion.message" ng-show="ruleQuestionClass && ruleQuestionClass != \'default\'"></img>\n      <p ng-show="ruleQuestion.message" ng-bind-html="ruleQuestion.message | trustedHtml"></p>\n    </div>\n    <div ng-class="{\'no-message\': !ruleQuestion.message, message: ruleQuestion.message}">\n      <button ng-show="showCheckAnswerButton" ng-click="checkAnswer()">{{checkAnswerText}}</button>\n      <ng-transclude></ng-transclude>\n    </div>\n  </div>\n</div>\n'),$templateCache.put("proofreader-result-large-flag.html",'<div class="proofreading-sample-results">\n  <img class="large" ng-class="rankingClass" src="/assets/images/big_result_flag.png" alt="results flag"></img>\n</div>\n'),$templateCache.put("proofreader-sample-result.html",'<div class="proofreading-sample-results" ng-show="ranking">\n  <img ng-class="rankingClass" src="/assets/images/small_result_flag.png" alt="results flag"></img>\n  <p>{{ranking}}</p>\n  <p>{{score}}</p>\n  <a ui-sref="play-internal-results({partnerIframe:true, passageId: \'{{uid}}\'})">\n    <p class="full-results">View Full Results</p>\n  </a>\n</div>\n')}])},{}],"/home/will/Clients/Quill/Quill-Grammar/node_modules/empirical-angular/directives/typing_speed.js":[function(require,module,exports){module.exports=["TypingSpeed","_",function(TypingSpeed,_){return{restrict:"A",require:"^ngModel",link:function(scope,element,attrs,model){function getWordCount(){var text=model.$viewValue;return text.trim().length?text.split(" ").length:0}TypingSpeed.waitTime=500,element.on("keydown",function(){TypingSpeed.startTracking()}),element.on("keyup blur",_.debounce(function(){TypingSpeed.wordCount=getWordCount(),TypingSpeed.stopTracking()},TypingSpeed.waitTime))}}}]},{}],"/home/will/Clients/Quill/Quill-Grammar/node_modules/empirical-angular/index.js":[function(require,module,exports){module.exports=angular.module("empirical-angular",["firebase"]).service("ActivitySession",require("./services/activity_session.js")).service("ConceptTagResult",require("./services/concept_tag_result.js")).service("TypingSpeed",require("./services/typing_speed.js")).directive("typingSpeed",require("./directives/typing_speed.js"))},{"./directives/typing_speed.js":"/home/will/Clients/Quill/Quill-Grammar/node_modules/empirical-angular/directives/typing_speed.js","./services/activity_session.js":"/home/will/Clients/Quill/Quill-Grammar/node_modules/empirical-angular/services/activity_session.js","./services/concept_tag_result.js":"/home/will/Clients/Quill/Quill-Grammar/node_modules/empirical-angular/services/concept_tag_result.js","./services/typing_speed.js":"/home/will/Clients/Quill/Quill-Grammar/node_modules/empirical-angular/services/typing_speed.js"}],"/home/will/Clients/Quill/Quill-Grammar/node_modules/empirical-angular/services/activity_session.js":[function(require,module,exports){module.exports=["$http","empiricalBaseURL",function($http,empiricalBaseURL){function activitySessionUrl(id){return empiricalBaseURL+"/activity_sessions/"+id}function update(id,putData,cb){return $http.put(activitySessionUrl(id),putData)}var activitySession=this;activitySession.finish=function(sessionId,putData,cb){return putData.state="finished",update(sessionId,putData).then(function(response){return response.data.activity_session})}}]},{}],"/home/will/Clients/Quill/Quill-Grammar/node_modules/empirical-angular/services/concept_tag_result.js":[function(require,module,exports){module.exports=["$firebase","firebaseUrl",function($firebase,firebaseUrl){function getResultList(activitySessionId){var resultList=$firebase(resultsRef.child(activitySessionId)).$asArray();return resultList.$loaded()}var conceptTagResult=this,resultsRef=new Firebase(firebaseUrl+"/concept_tag_results");conceptTagResult.save=function(activitySessionId,data,cb){return getResultList(activitySessionId).then(function(list){return list.$add(data)})},conceptTagResult.findAsJsonByActivitySessionId=function(activitySessionId){return getResultList(activitySessionId).then(function(list){return list.map(function(fbResultObject){var clean=JSON.parse(JSON.stringify(fbResultObject));return delete clean.$id,delete clean.$priority,clean})})},conceptTagResult.removeBySessionId=function(activitySessionId){return $firebase(resultsRef).$remove(activitySessionId)}}]},{}],"/home/will/Clients/Quill/Quill-Grammar/node_modules/empirical-angular/services/typing_speed.js":[function(require,module,exports){function TypingSpeed(){}module.exports=TypingSpeed,TypingSpeed.prototype={reset:function(){this._tracking=!1,this._startTime=null,this.wordCount=null,this.waitTime=null},startTracking:function(){this._tracking||(this._startTime||(this._startTime=new Date),this._tracking=!0)},stopTracking:function(){if(this._tracking){this._tracking=!1;var endTime=new Date,totalSeconds=this._getElapsedSeconds(this._startTime,endTime,this.waitTime);this.wordsPerMinute=Math.floor(this._getWordsPerMinute(totalSeconds,this.wordCount))}},_getElapsedSeconds:function(startTime,endTime,waitTime){var diff=endTime-startTime;return waitTime&&(diff-=waitTime),diff/1e3},_getWordsPerMinute:function(seconds,wordCount){return wordCount/(seconds/60)}}},{}],"/home/will/Clients/Quill/Quill-Grammar/node_modules/ng-autofocus/autofocus.js":[function(require,module,exports){!function(){"use strict";function Autofocus($timeout){function link($scope,$element,$attrs){function focusIf(condition){delay=delay||0,condition&&$timeout(function(){dom.focus()},delay)}var dom=$element[0],delay=$attrs.autofocusDelay;$attrs.autofocus?(focusIf($scope[$attrs.autofocus]),$scope.$watch($attrs.autofocus,focusIf)):focusIf(!0)}return{restrict:"A",link:link}}angular.module("autofocus",[]).directive("autofocus",Autofocus),Autofocus.$inject=["$timeout"]}()},{}],"/home/will/Clients/Quill/Quill-Grammar/node_modules/ramda/dist/ramda.js":[function(require,module,exports){(function(){"use strict";var __={"@@functional/placeholder":!0},_add=function(a,b){return a+b},_all=function(fn,list){for(var idx=0;idx<list.length;){if(!fn(list[idx]))return!1;idx+=1}return!0},_any=function(fn,list){for(var idx=0;idx<list.length;){if(fn(list[idx]))return!0;idx+=1}return!1},_assoc=function(prop,val,obj){var result={};for(var p in obj)result[p]=obj[p];return result[prop]=val,result},_cloneRegExp=function(pattern){return new RegExp(pattern.source,(pattern.global?"g":"")+(pattern.ignoreCase?"i":"")+(pattern.multiline?"m":"")+(pattern.sticky?"y":"")+(pattern.unicode?"u":""))},_complement=function(f){return function(){return!f.apply(this,arguments)}},_compose=function(f,g){return function(){return f.call(this,g.apply(this,arguments))}},_concat=function(set1,set2){set1=set1||[],set2=set2||[];var idx,len1=set1.length,len2=set2.length,result=[];for(idx=0;len1>idx;)result[result.length]=set1[idx],idx+=1;for(idx=0;len2>idx;)result[result.length]=set2[idx],idx+=1;return result},_containsWith=function(pred,x,list){for(var idx=0,len=list.length;len>idx;){if(pred(x,list[idx]))return!0;idx+=1}return!1},_createMapEntry=function(key,val){var obj={};return obj[key]=val,obj},_createMaxMinBy=function(comparator){return function(valueComputer,list){if(list&&list.length>0){for(var computedCurrent,idx=1,winner=list[idx],computedWinner=valueComputer(winner);idx<list.length;)computedCurrent=valueComputer(list[idx]),comparator(computedCurrent,computedWinner)&&(computedWinner=computedCurrent,winner=list[idx]),idx+=1;return winner}}},_curry1=function(fn){return function f1(a){return 0===arguments.length?f1:null!=a&&a["@@functional/placeholder"]===!0?f1:fn(a)}},_curry2=function(fn){return function f2(a,b){var n=arguments.length;return 0===n?f2:1===n&&null!=a&&a["@@functional/placeholder"]===!0?f2:1===n?_curry1(function(b){return fn(a,b)}):2===n&&null!=a&&a["@@functional/placeholder"]===!0&&null!=b&&b["@@functional/placeholder"]===!0?f2:2===n&&null!=a&&a["@@functional/placeholder"]===!0?_curry1(function(a){return fn(a,b)}):2===n&&null!=b&&b["@@functional/placeholder"]===!0?_curry1(function(b){return fn(a,b)}):fn(a,b)}},_curry3=function(fn){return function f3(a,b,c){var n=arguments.length;return 0===n?f3:1===n&&null!=a&&a["@@functional/placeholder"]===!0?f3:1===n?_curry2(function(b,c){return fn(a,b,c)}):2===n&&null!=a&&a["@@functional/placeholder"]===!0&&null!=b&&b["@@functional/placeholder"]===!0?f3:2===n&&null!=a&&a["@@functional/placeholder"]===!0?_curry2(function(a,c){return fn(a,b,c)}):2===n&&null!=b&&b["@@functional/placeholder"]===!0?_curry2(function(b,c){return fn(a,b,c)}):2===n?_curry1(function(c){return fn(a,b,c)}):3===n&&null!=a&&a["@@functional/placeholder"]===!0&&null!=b&&b["@@functional/placeholder"]===!0&&null!=c&&c["@@functional/placeholder"]===!0?f3:3===n&&null!=a&&a["@@functional/placeholder"]===!0&&null!=b&&b["@@functional/placeholder"]===!0?_curry2(function(a,b){return fn(a,b,c)}):3===n&&null!=a&&a["@@functional/placeholder"]===!0&&null!=c&&c["@@functional/placeholder"]===!0?_curry2(function(a,c){return fn(a,b,c)}):3===n&&null!=b&&b["@@functional/placeholder"]===!0&&null!=c&&c["@@functional/placeholder"]===!0?_curry2(function(b,c){return fn(a,b,c)}):3===n&&null!=a&&a["@@functional/placeholder"]===!0?_curry1(function(a){return fn(a,b,c)}):3===n&&null!=b&&b["@@functional/placeholder"]===!0?_curry1(function(b){return fn(a,b,c)}):3===n&&null!=c&&c["@@functional/placeholder"]===!0?_curry1(function(c){return fn(a,b,c)}):fn(a,b,c)}},_dissoc=function(prop,obj){var result={};for(var p in obj)p!==prop&&(result[p]=obj[p]);return result},_eq=function(x,y){return x===y?0!==x||1/x===1/y:x!==x&&y!==y},_filter=function(fn,list){for(var idx=0,len=list.length,result=[];len>idx;)fn(list[idx])&&(result[result.length]=list[idx]),idx+=1;return result},_filterIndexed=function(fn,list){for(var idx=0,len=list.length,result=[];len>idx;)fn(list[idx],idx,list)&&(result[result.length]=list[idx]),idx+=1;return result},_forEach=function(fn,list){for(var idx=0,len=list.length;len>idx;)fn(list[idx]),idx+=1;return list},_forceReduced=function(x){return{"@@transducer/value":x,"@@transducer/reduced":!0}},_functionsWith=function(fn){return function(obj){return _filter(function(key){return"function"==typeof obj[key]},fn(obj))}},_gt=function(a,b){return a>b},_has=function(prop,obj){return Object.prototype.hasOwnProperty.call(obj,prop)},_identity=function(x){return x},_isArray=Array.isArray||function(val){return null!=val&&val.length>=0&&"[object Array]"===Object.prototype.toString.call(val)},_isInteger=Number.isInteger||function(n){return n<<0===n},_isThenable=function(value){return null!=value&&value===Object(value)&&"function"==typeof value.then},_isTransformer=function(obj){return"function"==typeof obj["@@transducer/step"]},_lt=function(a,b){return b>a},_map=function(fn,list){for(var idx=0,len=list.length,result=[];len>idx;)result[idx]=fn(list[idx]),idx+=1;return result},_multiply=function(a,b){return a*b},_nth=function(n,list){return 0>n?list[list.length+n]:list[n]},_path=function(paths,obj){if(null!=obj){for(var val=obj,idx=0,len=paths.length;len>idx&&null!=val;idx+=1)val=val[paths[idx]];return val}},_prepend=function(el,list){return _concat([el],list)},_quote=function(s){return'"'+s.replace(/"/g,'\\"')+'"'},_reduced=function(x){return x&&x["@@transducer/reduced"]?x:{"@@transducer/value":x,"@@transducer/reduced":!0}},_slice=function _slice(args,from,to){switch(arguments.length){case 1:return _slice(args,0,args.length);case 2:return _slice(args,from,args.length);default:for(var list=[],idx=0,len=Math.max(0,Math.min(args.length,to)-from);len>idx;)list[idx]=args[from+idx],idx+=1;return list}},_toISOString=function(){var pad=function(n){return(10>n?"0":"")+n};return"function"==typeof Date.prototype.toISOString?function(d){return d.toISOString()}:function(d){return d.getUTCFullYear()+"-"+pad(d.getUTCMonth()+1)+"-"+pad(d.getUTCDate())+"T"+pad(d.getUTCHours())+":"+pad(d.getUTCMinutes())+":"+pad(d.getUTCSeconds())+"."+(d.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}(),_xdropRepeatsWith=function(){function XDropRepeatsWith(pred,xf){this.xf=xf,this.pred=pred,this.lastValue=void 0,this.seenFirstValue=!1}return XDropRepeatsWith.prototype["@@transducer/init"]=function(){return this.xf["@@transducer/init"]()},XDropRepeatsWith.prototype["@@transducer/result"]=function(result){return this.xf["@@transducer/result"](result)},XDropRepeatsWith.prototype["@@transducer/step"]=function(result,input){var sameAsLast=!1;return this.seenFirstValue?this.pred(this.lastValue,input)&&(sameAsLast=!0):this.seenFirstValue=!0,this.lastValue=input,sameAsLast?result:this.xf["@@transducer/step"](result,input)},_curry2(function(pred,xf){return new XDropRepeatsWith(pred,xf)})}(),_xfBase={init:function(){return this.xf["@@transducer/init"]()},result:function(result){return this.xf["@@transducer/result"](result)}},_xfilter=function(){function XFilter(f,xf){this.xf=xf,this.f=f}return XFilter.prototype["@@transducer/init"]=_xfBase.init,XFilter.prototype["@@transducer/result"]=_xfBase.result,XFilter.prototype["@@transducer/step"]=function(result,input){return this.f(input)?this.xf["@@transducer/step"](result,input):result},_curry2(function(f,xf){return new XFilter(f,xf)})}(),_xfind=function(){function XFind(f,xf){this.xf=xf,this.f=f,this.found=!1}return XFind.prototype["@@transducer/init"]=_xfBase.init,XFind.prototype["@@transducer/result"]=function(result){return this.found||(result=this.xf["@@transducer/step"](result,void 0)),this.xf["@@transducer/result"](result)},XFind.prototype["@@transducer/step"]=function(result,input){return this.f(input)&&(this.found=!0,result=_reduced(this.xf["@@transducer/step"](result,input))),result},_curry2(function(f,xf){return new XFind(f,xf)})}(),_xfindIndex=function(){function XFindIndex(f,xf){this.xf=xf,this.f=f,this.idx=-1,this.found=!1}return XFindIndex.prototype["@@transducer/init"]=_xfBase.init,XFindIndex.prototype["@@transducer/result"]=function(result){return this.found||(result=this.xf["@@transducer/step"](result,-1)),this.xf["@@transducer/result"](result)},XFindIndex.prototype["@@transducer/step"]=function(result,input){return this.idx+=1,this.f(input)&&(this.found=!0,result=_reduced(this.xf["@@transducer/step"](result,this.idx))),result},_curry2(function(f,xf){return new XFindIndex(f,xf)})}(),_xfindLast=function(){function XFindLast(f,xf){this.xf=xf,this.f=f}return XFindLast.prototype["@@transducer/init"]=_xfBase.init,XFindLast.prototype["@@transducer/result"]=function(result){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](result,this.last))},XFindLast.prototype["@@transducer/step"]=function(result,input){return this.f(input)&&(this.last=input),result},_curry2(function(f,xf){return new XFindLast(f,xf)})}(),_xfindLastIndex=function(){function XFindLastIndex(f,xf){this.xf=xf,this.f=f,this.idx=-1,this.lastIdx=-1}return XFindLastIndex.prototype["@@transducer/init"]=_xfBase.init,XFindLastIndex.prototype["@@transducer/result"]=function(result){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](result,this.lastIdx))},XFindLastIndex.prototype["@@transducer/step"]=function(result,input){return this.idx+=1,this.f(input)&&(this.lastIdx=this.idx),result},_curry2(function(f,xf){return new XFindLastIndex(f,xf)})}(),_xmap=function(){function XMap(f,xf){this.xf=xf,this.f=f}return XMap.prototype["@@transducer/init"]=_xfBase.init,XMap.prototype["@@transducer/result"]=_xfBase.result,XMap.prototype["@@transducer/step"]=function(result,input){return this.xf["@@transducer/step"](result,this.f(input))},_curry2(function(f,xf){return new XMap(f,xf)})}(),_xtake=function(){function XTake(n,xf){this.xf=xf,this.n=n}return XTake.prototype["@@transducer/init"]=_xfBase.init,XTake.prototype["@@transducer/result"]=_xfBase.result,XTake.prototype["@@transducer/step"]=function(result,input){return this.n-=1,0===this.n?_reduced(this.xf["@@transducer/step"](result,input)):this.xf["@@transducer/step"](result,input)},_curry2(function(n,xf){return new XTake(n,xf)})}(),_xtakeWhile=function(){function XTakeWhile(f,xf){this.xf=xf,this.f=f}return XTakeWhile.prototype["@@transducer/init"]=_xfBase.init,XTakeWhile.prototype["@@transducer/result"]=_xfBase.result,XTakeWhile.prototype["@@transducer/step"]=function(result,input){return this.f(input)?this.xf["@@transducer/step"](result,input):_reduced(result)},_curry2(function(f,xf){return new XTakeWhile(f,xf)})}(),_xwrap=function(){function XWrap(fn){this.f=fn}return XWrap.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},XWrap.prototype["@@transducer/result"]=function(acc){return acc},XWrap.prototype["@@transducer/step"]=function(acc,x){return this.f(acc,x)},function(fn){return new XWrap(fn)}}(),add=_curry2(_add),adjust=_curry3(function(fn,idx,list){if(idx>=list.length||idx<-list.length)return list;var start=0>idx?list.length:0,_idx=start+idx,_list=_concat(list);return _list[_idx]=fn(list[_idx]),_list}),always=_curry1(function(val){return function(){return val}}),aperture=_curry2(function(n,list){for(var idx=0,limit=list.length-(n-1),acc=new Array(limit>=0?limit:0);limit>idx;)acc[idx]=_slice(list,idx,idx+n),idx+=1;return acc}),apply=_curry2(function(fn,args){return fn.apply(this,args)}),arity=_curry2(function(n,fn){switch(n){case 0:return function(){return fn.apply(this,arguments)};case 1:return function(a0){return fn.apply(this,arguments)};case 2:return function(a0,a1){return fn.apply(this,arguments)};case 3:return function(a0,a1,a2){return fn.apply(this,arguments)};case 4:return function(a0,a1,a2,a3){return fn.apply(this,arguments)};case 5:return function(a0,a1,a2,a3,a4){return fn.apply(this,arguments)};case 6:return function(a0,a1,a2,a3,a4,a5){return fn.apply(this,arguments)};case 7:return function(a0,a1,a2,a3,a4,a5,a6){return fn.apply(this,arguments)};case 8:return function(a0,a1,a2,a3,a4,a5,a6,a7){return fn.apply(this,arguments)};case 9:return function(a0,a1,a2,a3,a4,a5,a6,a7,a8){return fn.apply(this,arguments)};case 10:return function(a0,a1,a2,a3,a4,a5,a6,a7,a8,a9){return fn.apply(this,arguments)};default:throw new Error("First argument to arity must be a non-negative integer no greater than ten")}}),assoc=_curry3(_assoc),bind=_curry2(function(fn,thisObj){return arity(fn.length,function(){return fn.apply(thisObj,arguments)})}),both=_curry2(function(f,g){return function(){return f.apply(this,arguments)&&g.apply(this,arguments)}}),comparator=_curry1(function(pred){return function(a,b){return pred(a,b)?-1:pred(b,a)?1:0}}),complement=_curry1(_complement),cond=function(){var pairs=arguments;return function(){for(var idx=0;idx<pairs.length;){if(pairs[idx][0].apply(this,arguments))return pairs[idx][1].apply(this,arguments);idx+=1}}},containsWith=_curry3(_containsWith),countBy=_curry2(function(fn,list){for(var counts={},len=list.length,idx=0;len>idx;){var key=fn(list[idx]);counts[key]=(_has(key,counts)?counts[key]:0)+1,idx+=1}return counts}),createMapEntry=_curry2(_createMapEntry),dec=add(-1),defaultTo=_curry2(function(d,v){return null==v?d:v}),differenceWith=_curry3(function(pred,first,second){for(var out=[],idx=0,firstLen=first.length,containsPred=containsWith(pred);firstLen>idx;)containsPred(first[idx],second)||containsPred(first[idx],out)||(out[out.length]=first[idx]),idx+=1;return out}),dissoc=_curry2(_dissoc),divide=_curry2(function(a,b){return a/b}),either=_curry2(function(f,g){return function(){return f.apply(this,arguments)||g.apply(this,arguments)}}),eq=_curry2(_eq),evolve=_curry2(function evolve(transformations,object){var transformation,key,type,result={};for(key in object)transformation=transformations[key],type=typeof transformation,result[key]="function"===type?transformation(object[key]):"object"===type?evolve(transformations[key],object[key]):object[key];return result}),filterIndexed=_curry2(_filterIndexed),forEachIndexed=_curry2(function(fn,list){for(var idx=0,len=list.length;len>idx;)fn(list[idx],idx,list),idx+=1;return list}),fromPairs=_curry1(function(pairs){for(var idx=0,len=pairs.length,out={};len>idx;)_isArray(pairs[idx])&&pairs[idx].length&&(out[pairs[idx][0]]=pairs[idx][1]),idx+=1;return out}),gt=_curry2(_gt),gte=_curry2(function(a,b){return a>=b}),has=_curry2(_has),hasIn=_curry2(function(prop,obj){return prop in obj}),identical=_curry2(function(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b}),identity=_curry1(_identity),inc=add(1),insertAll=_curry3(function(idx,elts,list){return idx=idx<list.length&&idx>=0?idx:list.length,_concat(_concat(_slice(list,0,idx),elts),_slice(list,idx))}),is=_curry2(function(Ctor,val){return null!=val&&val.constructor===Ctor||val instanceof Ctor}),isArrayLike=_curry1(function(x){return _isArray(x)?!0:x?"object"!=typeof x?!1:x instanceof String?!1:1===x.nodeType?!!x.length:0===x.length?!0:x.length>0?x.hasOwnProperty(0)&&x.hasOwnProperty(x.length-1):!1:!1}),isEmpty=_curry1(function(list){return 0===Object(list).length}),isNil=_curry1(function(x){return null==x}),keys=function(){var hasEnumBug=!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],contains=function(list,item){for(var idx=0;idx<list.length;){if(list[idx]===item)return!0;idx+=1}return!1};return _curry1("function"==typeof Object.keys?function(obj){return Object(obj)!==obj?[]:Object.keys(obj)}:function(obj){if(Object(obj)!==obj)return[];var prop,nIdx,ks=[];for(prop in obj)_has(prop,obj)&&(ks[ks.length]=prop);if(hasEnumBug)for(nIdx=nonEnumerableProps.length-1;nIdx>=0;)prop=nonEnumerableProps[nIdx],_has(prop,obj)&&!contains(ks,prop)&&(ks[ks.length]=prop),nIdx-=1;return ks})}(),keysIn=_curry1(function(obj){var prop,ks=[];for(prop in obj)ks[ks.length]=prop;return ks}),length=_curry1(function(list){return null!=list&&is(Number,list.length)?list.length:0/0}),lens=_curry2(function(get,set){var lns=function(a){return get(a)};return lns.set=_curry2(set),lns.map=_curry2(function(fn,a){return set(fn(get(a)),a)}),lns}),lensOn=_curry3(function(get,set,obj){var lns=function(){return get(obj)};return lns.set=set,lns.map=function(fn){return set(fn(get(obj)))},lns}),lt=_curry2(_lt),lte=_curry2(function(a,b){return b>=a}),mapAccum=_curry3(function(fn,acc,list){for(var idx=0,len=list.length,result=[],tuple=[acc];len>idx;)tuple=fn(tuple[0],list[idx]),result[idx]=tuple[1],idx+=1;return[tuple[0],result]}),mapAccumRight=_curry3(function(fn,acc,list){for(var idx=list.length-1,result=[],tuple=[acc];idx>=0;)tuple=fn(tuple[0],list[idx]),result[idx]=tuple[1],idx-=1;return[tuple[0],result]}),mapIndexed=_curry2(function(fn,list){for(var idx=0,len=list.length,result=[];len>idx;)result[idx]=fn(list[idx],idx,list),idx+=1;return result}),mathMod=_curry2(function(m,p){return _isInteger(m)?!_isInteger(p)||1>p?0/0:(m%p+p)%p:0/0}),maxBy=_curry2(_createMaxMinBy(_gt)),minBy=_curry2(_createMaxMinBy(_lt)),modulo=_curry2(function(a,b){return a%b}),multiply=_curry2(_multiply),nAry=_curry2(function(n,fn){switch(n){case 0:return function(){return fn.call(this)};case 1:return function(a0){return fn.call(this,a0)};case 2:return function(a0,a1){return fn.call(this,a0,a1)};case 3:return function(a0,a1,a2){return fn.call(this,a0,a1,a2)};case 4:return function(a0,a1,a2,a3){return fn.call(this,a0,a1,a2,a3)};case 5:return function(a0,a1,a2,a3,a4){return fn.call(this,a0,a1,a2,a3,a4)};case 6:return function(a0,a1,a2,a3,a4,a5){return fn.call(this,a0,a1,a2,a3,a4,a5)};case 7:return function(a0,a1,a2,a3,a4,a5,a6){return fn.call(this,a0,a1,a2,a3,a4,a5,a6)};case 8:return function(a0,a1,a2,a3,a4,a5,a6,a7){return fn.call(this,a0,a1,a2,a3,a4,a5,a6,a7)};case 9:return function(a0,a1,a2,a3,a4,a5,a6,a7,a8){return fn.call(this,a0,a1,a2,a3,a4,a5,a6,a7,a8)};case 10:return function(a0,a1,a2,a3,a4,a5,a6,a7,a8,a9){return fn.call(this,a0,a1,a2,a3,a4,a5,a6,a7,a8,a9)};default:throw new Error("First argument to nAry must be a non-negative integer no greater than ten")}}),negate=_curry1(function(n){return-n}),not=_curry1(function(a){return!a}),nth=_curry2(_nth),nthArg=_curry1(function(n){return function(){return _nth(n,arguments)}}),nthChar=_curry2(function(n,str){return str.charAt(0>n?str.length+n:n)}),nthCharCode=_curry2(function(n,str){return str.charCodeAt(0>n?str.length+n:n)}),of=_curry1(function(x){return[x]}),once=_curry1(function(fn){var result,called=!1;return function(){return called?result:(called=!0,result=fn.apply(this,arguments))}}),path=_curry2(_path),pick=_curry2(function(names,obj){for(var result={},idx=0;idx<names.length;)names[idx]in obj&&(result[names[idx]]=obj[names[idx]]),idx+=1;return result}),pickAll=_curry2(function(names,obj){for(var result={},idx=0,len=names.length;len>idx;){var name=names[idx];result[name]=obj[name],idx+=1}return result}),pickBy=_curry2(function(test,obj){var result={};for(var prop in obj)test(obj[prop],prop,obj)&&(result[prop]=obj[prop]);return result}),prepend=_curry2(_prepend),prop=_curry2(function(p,obj){return obj[p]}),propOr=_curry3(function(val,p,obj){return null!=obj&&_has(p,obj)?obj[p]:val}),props=_curry2(function(ps,obj){for(var len=ps.length,out=[],idx=0;len>idx;)out[idx]=obj[ps[idx]],idx+=1;return out}),range=_curry2(function(from,to){for(var result=[],n=from;to>n;)result[result.length]=n,n+=1;return result}),reduceIndexed=_curry3(function(fn,acc,list){for(var idx=0,len=list.length;len>idx;)acc=fn(acc,list[idx],idx,list),idx+=1;return acc}),reduceRight=_curry3(function(fn,acc,list){for(var idx=list.length-1;idx>=0;)acc=fn(acc,list[idx]),idx-=1;return acc}),reduceRightIndexed=_curry3(function(fn,acc,list){for(var idx=list.length-1;idx>=0;)acc=fn(acc,list[idx],idx,list),idx-=1;return acc}),reduced=_curry1(_reduced),rejectIndexed=_curry2(function(fn,list){return _filterIndexed(_complement(fn),list)}),remove=_curry3(function(start,count,list){return _concat(_slice(list,0,Math.min(start,list.length)),_slice(list,Math.min(list.length,start+count)))}),replace=_curry3(function(regex,replacement,str){return str.replace(regex,replacement)}),reverse=_curry1(function(list){return _slice(list).reverse()}),scan=_curry3(function(fn,acc,list){for(var idx=0,len=list.length,result=[acc];len>idx;)acc=fn(acc,list[idx]),result[idx+1]=acc,idx+=1;return result}),sort=_curry2(function(comparator,list){return _slice(list).sort(comparator)}),sortBy=_curry2(function(fn,list){return _slice(list).sort(function(a,b){var aa=fn(a),bb=fn(b);return bb>aa?-1:aa>bb?1:0})}),strIndexOf=_curry2(function(c,str){return str.indexOf(c)}),strLastIndexOf=_curry2(function(c,str){return str.lastIndexOf(c)}),subtract=_curry2(function(a,b){return a-b}),tap=_curry2(function(fn,x){return fn(x),x}),test=_curry2(function(pattern,str){return _cloneRegExp(pattern).test(str)}),times=_curry2(function(fn,n){for(var len=Number(n),list=new Array(len),idx=0;len>idx;)list[idx]=fn(idx),idx+=1;return list}),toPairs=_curry1(function(obj){var pairs=[];for(var prop in obj)_has(prop,obj)&&(pairs[pairs.length]=[prop,obj[prop]]);return pairs}),toPairsIn=_curry1(function(obj){var pairs=[];for(var prop in obj)pairs[pairs.length]=[prop,obj[prop]];return pairs}),trim=function(){var ws="	\n\f\r   ᠎             　\u2028\u2029\ufeff",zeroWidth="​",hasProtoTrim="function"==typeof String.prototype.trim;return _curry1(hasProtoTrim&&!ws.trim()&&zeroWidth.trim()?function(str){return str.trim()}:function(str){var beginRx=new RegExp("^["+ws+"]["+ws+"]*"),endRx=new RegExp("["+ws+"]["+ws+"]*$");return str.replace(beginRx,"").replace(endRx,"")})}(),type=_curry1(function(val){return null===val?"Null":void 0===val?"Undefined":Object.prototype.toString.call(val).slice(8,-1)}),unapply=_curry1(function(fn){return function(){return fn(_slice(arguments))}}),unary=_curry1(function(fn){return nAry(1,fn)}),unfold=_curry2(function(fn,seed){for(var pair=fn(seed),result=[];pair&&pair.length;)result[result.length]=pair[0],pair=fn(pair[1]);return result}),uniqWith=_curry2(function(pred,list){for(var item,idx=0,len=list.length,result=[];len>idx;)item=list[idx],_containsWith(pred,item,result)||(result[result.length]=item),idx+=1;return result}),update=_curry3(function(idx,x,list){return adjust(always(x),idx,list)}),values=_curry1(function(obj){for(var props=keys(obj),len=props.length,vals=[],idx=0;len>idx;)vals[idx]=obj[props[idx]],idx+=1;return vals}),valuesIn=_curry1(function(obj){var prop,vs=[];for(prop in obj)vs[vs.length]=obj[prop];return vs}),where=_curry2(function(spec,testObj){for(var prop in spec)if(_has(prop,spec)&&!spec[prop](testObj[prop]))return!1;return!0}),xprod=_curry2(function(a,b){for(var j,idx=0,ilen=a.length,jlen=b.length,result=[];ilen>idx;){for(j=0;jlen>j;)result[result.length]=[a[idx],b[j]],j+=1;idx+=1}return result}),zip=_curry2(function(a,b){for(var rv=[],idx=0,len=Math.min(a.length,b.length);len>idx;)rv[idx]=[a[idx],b[idx]],idx+=1;return rv}),zipObj=_curry2(function(keys,values){for(var idx=0,len=keys.length,out={};len>idx;)out[keys[idx]]=values[idx],idx+=1;return out}),zipWith=_curry3(function(fn,a,b){for(var rv=[],idx=0,len=Math.min(a.length,b.length);len>idx;)rv[idx]=fn(a[idx],b[idx]),idx+=1;return rv}),F=always(!1),T=always(!0),_append=function(el,list){return _concat(list,[el])},_assocPath=function _assocPath(path,val,obj){switch(path.length){case 0:return obj;case 1:return _assoc(path[0],val,obj);default:return _assoc(path[0],_assocPath(_slice(path,1),val,Object(obj[path[0]])),obj);

}},_baseCopy=function _baseCopy(value,refFrom,refTo){var copy=function(copiedValue){for(var len=refFrom.length,idx=0;len>idx;){if(value===refFrom[idx])return refTo[idx];idx+=1}refFrom[idx+1]=value,refTo[idx+1]=copiedValue;for(var key in value)copiedValue[key]=_baseCopy(value[key],refFrom,refTo);return copiedValue};switch(type(value)){case"Object":return copy({});case"Array":return copy([]);case"Date":return new Date(value);case"RegExp":return _cloneRegExp(value);default:return value}},_checkForMethod=function(methodname,fn){return function(){var length=arguments.length;if(0===length)return fn();var obj=arguments[length-1];return _isArray(obj)||"function"!=typeof obj[methodname]?fn.apply(this,arguments):obj[methodname].apply(obj,_slice(arguments,0,length-1))}},_composeL=function(innerLens,outerLens){return lens(_compose(innerLens,outerLens),function(x,source){var newInnerValue=innerLens.set(x,outerLens(source));return outerLens.set(newInnerValue,source)})},_composeP=function(f,g){return function(){var context=this,value=g.apply(this,arguments);return _isThenable(value)?value.then(function(result){return f.call(context,result)}):f.call(this,value)}},_createComposer=function(composeFunction){return function(){for(var fn=arguments[arguments.length-1],length=fn.length,idx=arguments.length-2;idx>=0;)fn=composeFunction(arguments[idx],fn),idx-=1;return arity(length,fn)}},_createMaxMin=function(comparator,initialVal){return _curry1(function(list){for(var computed,idx=0,winner=initialVal;idx<list.length;)computed=+list[idx],comparator(computed,winner)&&(winner=computed),idx+=1;return winner})},_createPartialApplicator=function(concat){return function(fn){var args=_slice(arguments,1);return arity(Math.max(0,fn.length-args.length),function(){return fn.apply(this,concat(args,arguments))})}},_curryN=function _curryN(length,received,fn){return function(){for(var combined=[],argsIdx=0,left=length,combinedIdx=0;combinedIdx<received.length||argsIdx<arguments.length;){var result;combinedIdx<received.length&&(null==received[combinedIdx]||received[combinedIdx]["@@functional/placeholder"]!==!0||argsIdx>=arguments.length)?result=received[combinedIdx]:(result=arguments[argsIdx],argsIdx+=1),combined[combinedIdx]=result,(null==result||result["@@functional/placeholder"]!==!0)&&(left-=1),combinedIdx+=1}return 0>=left?fn.apply(this,combined):arity(left,_curryN(length,combined,fn))}},_dispatchable=function(methodname,xf,fn){return function(){var length=arguments.length;if(0===length)return fn();var obj=arguments[length-1];if(!_isArray(obj)){var args=_slice(arguments,0,length-1);if("function"==typeof obj[methodname])return obj[methodname].apply(obj,args);if(_isTransformer(obj)){var transducer=xf.apply(null,args);return transducer(obj)}}return fn.apply(this,arguments)}},_dissocPath=function _dissocPath(path,obj){switch(path.length){case 0:return obj;case 1:return _dissoc(path[0],obj);default:var head=path[0],tail=_slice(path,1);return null==obj[head]?obj:_assoc(head,_dissocPath(tail,obj[head]),obj)}},_equals=function _eqDeep(a,b,stackA,stackB){var typeA=type(a);if(typeA!==type(b))return!1;if("Boolean"===typeA||"Number"===typeA||"String"===typeA)return"object"==typeof a?"object"==typeof b&&identical(a.valueOf(),b.valueOf()):identical(a,b);if(identical(a,b))return!0;if("RegExp"===typeA)return a.source===b.source&&a.global===b.global&&a.ignoreCase===b.ignoreCase&&a.multiline===b.multiline&&a.sticky===b.sticky&&a.unicode===b.unicode;if(Object(a)===a){if("Date"===typeA&&a.getTime()!==b.getTime())return!1;var keysA=keys(a);if(keysA.length!==keys(b).length)return!1;for(var idx=stackA.length-1;idx>=0;){if(stackA[idx]===a)return stackB[idx]===b;idx-=1}for(stackA[stackA.length]=a,stackB[stackB.length]=b,idx=keysA.length-1;idx>=0;){var key=keysA[idx];if(!_has(key,b)||!_eqDeep(b[key],a[key],stackA,stackB))return!1;idx-=1}return stackA.pop(),stackB.pop(),!0}return!1},_extend=function(destination,other){for(var props=keys(other),idx=0,length=props.length;length>idx;)destination[props[idx]]=other[props[idx]],idx+=1;return destination},_hasMethod=function(methodName,obj){return null!=obj&&!_isArray(obj)&&"function"==typeof obj[methodName]},_makeFlat=function(recursive){return function flatt(list){for(var value,j,jlen,result=[],idx=0,ilen=list.length;ilen>idx;){if(isArrayLike(list[idx]))for(value=recursive?flatt(list[idx]):list[idx],j=0,jlen=value.length;jlen>j;)result[result.length]=value[j],j+=1;else result[result.length]=list[idx];idx+=1}return result}},_reduce=function(){function _arrayReduce(xf,acc,list){for(var idx=0,len=list.length;len>idx;){if(acc=xf["@@transducer/step"](acc,list[idx]),acc&&acc["@@transducer/reduced"]){acc=acc["@@transducer/value"];break}idx+=1}return xf["@@transducer/result"](acc)}function _iterableReduce(xf,acc,iter){for(var step=iter.next();!step.done;){if(acc=xf["@@transducer/step"](acc,step.value),acc&&acc["@@transducer/reduced"]){acc=acc["@@transducer/value"];break}step=iter.next()}return xf["@@transducer/result"](acc)}function _methodReduce(xf,acc,obj){return xf["@@transducer/result"](obj.reduce(bind(xf["@@transducer/step"],xf),acc))}var symIterator="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";return function(fn,acc,list){if("function"==typeof fn&&(fn=_xwrap(fn)),isArrayLike(list))return _arrayReduce(fn,acc,list);if("function"==typeof list.reduce)return _methodReduce(fn,acc,list);if(null!=list[symIterator])return _iterableReduce(fn,acc,list[symIterator]());if("function"==typeof list.next)return _iterableReduce(fn,acc,list);throw new TypeError("reduce: list must be array or iterable")}}(),_xall=function(){function XAll(f,xf){this.xf=xf,this.f=f,this.all=!0}return XAll.prototype["@@transducer/init"]=_xfBase.init,XAll.prototype["@@transducer/result"]=function(result){return this.all&&(result=this.xf["@@transducer/step"](result,!0)),this.xf["@@transducer/result"](result)},XAll.prototype["@@transducer/step"]=function(result,input){return this.f(input)||(this.all=!1,result=_reduced(this.xf["@@transducer/step"](result,!1))),result},_curry2(function(f,xf){return new XAll(f,xf)})}(),_xany=function(){function XAny(f,xf){this.xf=xf,this.f=f,this.any=!1}return XAny.prototype["@@transducer/init"]=_xfBase.init,XAny.prototype["@@transducer/result"]=function(result){return this.any||(result=this.xf["@@transducer/step"](result,!1)),this.xf["@@transducer/result"](result)},XAny.prototype["@@transducer/step"]=function(result,input){return this.f(input)&&(this.any=!0,result=_reduced(this.xf["@@transducer/step"](result,!0))),result},_curry2(function(f,xf){return new XAny(f,xf)})}(),_xdrop=function(){function XDrop(n,xf){this.xf=xf,this.n=n}return XDrop.prototype["@@transducer/init"]=_xfBase.init,XDrop.prototype["@@transducer/result"]=_xfBase.result,XDrop.prototype.step=function(result,input){return this.n>0?(this.n-=1,result):this.xf["@@transducer/step"](result,input)},_curry2(function(n,xf){return new XDrop(n,xf)})}(),_xdropWhile=function(){function XDropWhile(f,xf){this.xf=xf,this.f=f}return XDropWhile.prototype["@@transducer/init"]=_xfBase.init,XDropWhile.prototype["@@transducer/result"]=_xfBase.result,XDropWhile.prototype["@@transducer/step"]=function(result,input){if(this.f){if(this.f(input))return result;this.f=null}return this.xf["@@transducer/step"](result,input)},_curry2(function(f,xf){return new XDropWhile(f,xf)})}(),_xgroupBy=function(){function XGroupBy(f,xf){this.xf=xf,this.f=f,this.inputs={}}return XGroupBy.prototype["@@transducer/init"]=_xfBase.init,XGroupBy.prototype["@@transducer/result"]=function(result){var key;for(key in this.inputs)if(_has(key,this.inputs)&&(result=this.xf["@@transducer/step"](result,this.inputs[key]),result["@@transducer/reduced"])){result=result["@@transducer/value"];break}return this.xf["@@transducer/result"](result)},XGroupBy.prototype["@@transducer/step"]=function(result,input){var key=this.f(input);return this.inputs[key]=this.inputs[key]||[key,[]],this.inputs[key][1]=_append(input,this.inputs[key][1]),result},_curry2(function(f,xf){return new XGroupBy(f,xf)})}(),all=_curry2(_dispatchable("all",_xall,_all)),and=_curry2(function(a,b){return _hasMethod("and",a)?a.and(b):a&&b}),any=_curry2(_dispatchable("any",_xany,_any)),append=_curry2(_append),assocPath=_curry3(_assocPath),binary=_curry1(function(fn){return nAry(2,fn)}),clone=_curry1(function(value){return _baseCopy(value,[],[])}),compose=_createComposer(_compose),composeL=function(){for(var fn=arguments[arguments.length-1],idx=arguments.length-2;idx>=0;)fn=_composeL(arguments[idx],fn),idx-=1;return fn},composeP=_createComposer(_composeP),concat=_curry2(function(set1,set2){if(_isArray(set2))return _concat(set1,set2);if(_hasMethod("concat",set1))return set1.concat(set2);throw new TypeError("can't concat "+typeof set1)}),curryN=_curry2(function(length,fn){return arity(length,_curryN(length,[],fn))}),dissocPath=_curry2(_dissocPath),dropWhile=_curry2(_dispatchable("dropWhile",_xdropWhile,function(pred,list){for(var idx=0,len=list.length;len>idx&&pred(list[idx]);)idx+=1;return _slice(list,idx)})),empty=_curry1(function(x){return _hasMethod("empty",x)?x.empty():[]}),equals=_curry2(function(a,b){return _hasMethod("equals",a)?a.equals(b):_hasMethod("equals",b)?b.equals(a):_equals(a,b,[],[])}),filter=_curry2(_dispatchable("filter",_xfilter,_filter)),find=_curry2(_dispatchable("find",_xfind,function(fn,list){for(var idx=0,len=list.length;len>idx;){if(fn(list[idx]))return list[idx];idx+=1}})),findIndex=_curry2(_dispatchable("findIndex",_xfindIndex,function(fn,list){for(var idx=0,len=list.length;len>idx;){if(fn(list[idx]))return idx;idx+=1}return-1})),findLast=_curry2(_dispatchable("findLast",_xfindLast,function(fn,list){for(var idx=list.length-1;idx>=0;){if(fn(list[idx]))return list[idx];idx-=1}})),findLastIndex=_curry2(_dispatchable("findLastIndex",_xfindLastIndex,function(fn,list){for(var idx=list.length-1;idx>=0;){if(fn(list[idx]))return idx;idx-=1}return-1})),flatten=_curry1(_makeFlat(!0)),forEach=_curry2(function(fn,list){return _hasMethod("forEach",list)?list.forEach(fn):_forEach(fn,list)}),functions=_curry1(_functionsWith(keys)),functionsIn=_curry1(_functionsWith(keysIn)),groupBy=_curry2(_dispatchable("groupBy",_xgroupBy,function(fn,list){return _reduce(function(acc,elt){var key=fn(elt);return acc[key]=_append(elt,acc[key]||(acc[key]=[])),acc},{},list)})),head=nth(0),ifElse=_curry3(function(condition,onTrue,onFalse){return curryN(Math.max(condition.length,onTrue.length,onFalse.length),function(){return condition.apply(this,arguments)?onTrue.apply(this,arguments):onFalse.apply(this,arguments)})}),insert=_curry3(function(idx,elt,list){return idx=idx<list.length&&idx>=0?idx:list.length,_concat(_append(elt,_slice(list,0,idx)),_slice(list,idx))}),intersectionWith=_curry3(function(pred,list1,list2){for(var results=[],idx=0;idx<list1.length;)_containsWith(pred,list1[idx],list2)&&(results[results.length]=list1[idx]),idx+=1;return uniqWith(pred,results)}),intersperse=_curry2(_checkForMethod("intersperse",function(separator,list){for(var out=[],idx=0,length=list.length;length>idx;)idx===length-1?out.push(list[idx]):out.push(list[idx],separator),idx+=1;return out})),invert=_curry1(function(obj){for(var props=keys(obj),len=props.length,idx=0,out={};len>idx;){var key=props[idx],val=obj[key],list=_has(val,out)?out[val]:out[val]=[];list[list.length]=key,idx+=1}return out}),invertObj=_curry1(function(obj){for(var props=keys(obj),len=props.length,idx=0,out={};len>idx;){var key=props[idx];out[obj[key]]=key,idx+=1}return out}),invoker=_curry2(function(arity,method){return curryN(arity+1,function(){var target=arguments[arity];return target[method].apply(target,_slice(arguments,0,arity))})}),join=invoker(1,"join"),last=nth(-1),lensIndex=_curry1(function(n){return lens(nth(n),update(n))}),lensProp=_curry1(function(k){return lens(prop(k),assoc(k))}),map=_curry2(_dispatchable("map",_xmap,_map)),mapObj=_curry2(function(fn,obj){return _reduce(function(acc,key){return acc[key]=fn(obj[key]),acc},{},keys(obj))}),mapObjIndexed=_curry2(function(fn,obj){return _reduce(function(acc,key){return acc[key]=fn(obj[key],key,obj),acc},{},keys(obj))}),match=invoker(1,"match"),max=_createMaxMin(_gt,-(1/0)),merge=_curry2(function(a,b){return _extend(_extend({},a),b)}),min=_createMaxMin(_lt,1/0),none=_curry2(_complement(_dispatchable("any",_xany,_any))),or=_curry2(function(a,b){return _hasMethod("or",a)?a.or(b):a||b}),partition=_curry2(function(pred,list){return _reduce(function(acc,elt){var xs=acc[pred(elt)?0:1];return xs[xs.length]=elt,acc},[[],[]],list)}),pathEq=_curry3(function(path,val,obj){return equals(_path(path,obj),val)}),pipe=function(){return compose.apply(this,reverse(arguments))},pipeL=compose(apply(composeL),unapply(reverse)),pipeP=function(){return composeP.apply(this,reverse(arguments))},propEq=_curry3(function(name,val,obj){return equals(obj[name],val)}),reduce=_curry3(_reduce),reject=_curry2(function(fn,list){return filter(_complement(fn),list)}),repeat=_curry2(function(value,n){return times(always(value),n)}),slice=_curry3(_checkForMethod("slice",function(fromIndex,toIndex,xs){return Array.prototype.slice.call(xs,fromIndex,toIndex)})),split=invoker(1,"split"),substring=slice,substringFrom=substring(__,1/0),substringTo=substring(0),sum=reduce(_add,0),tail=_checkForMethod("tail",function(list){return _slice(list,1)}),take=_curry2(_dispatchable("take",_xtake,function(n,xs){return slice(0,0>n?1/0:n,xs)})),takeWhile=_curry2(_dispatchable("takeWhile",_xtakeWhile,function(fn,list){for(var idx=0,len=list.length;len>idx&&fn(list[idx]);)idx+=1;return _slice(list,0,idx)})),toLower=invoker(0,"toLowerCase"),toUpper=invoker(0,"toUpperCase"),transduce=curryN(4,function(xf,fn,acc,list){return _reduce(xf("function"==typeof fn?_xwrap(fn):fn),acc,list)}),uncurryN=_curry2(function(depth,fn){return curryN(depth,function(){for(var endIdx,currentDepth=1,value=fn,idx=0;depth>=currentDepth&&"function"==typeof value;)endIdx=currentDepth===depth?arguments.length:idx+value.length,value=value.apply(this,_slice(arguments,idx,endIdx)),currentDepth+=1,idx=endIdx;return value})}),unionWith=_curry3(function(pred,list1,list2){return uniqWith(pred,_concat(list1,list2))}),uniq=uniqWith(equals),unnest=_curry1(_makeFlat(!1)),whereEq=_curry2(function(spec,testObj){return where(mapObj(equals,spec),testObj)}),wrap=_curry2(function(fn,wrapper){return curryN(fn.length,function(){return wrapper.apply(this,_concat([fn],arguments))})}),_chain=_curry2(function(f,list){return unnest(map(f,list))}),_flatCat=function(){var preservingReduced=function(xf){return{"@@transducer/init":_xfBase.init,"@@transducer/result":function(result){return xf["@@transducer/result"](result)},"@@transducer/step":function(result,input){var ret=xf["@@transducer/step"](result,input);return ret["@@transducer/reduced"]?_forceReduced(ret):ret}}};return function(xf){var rxf=preservingReduced(xf);return{"@@transducer/init":_xfBase.init,"@@transducer/result":function(result){return rxf["@@transducer/result"](result)},"@@transducer/step":function(result,input){return isArrayLike(input)?_reduce(rxf,result,input):_reduce(rxf,result,[input])}}}}(),_indexOf=function(list,item,from){var idx=0,len=list.length;for("number"==typeof from&&(idx=0>from?Math.max(0,len+from):from);len>idx;){if(equals(list[idx],item))return idx;idx+=1}return-1},_lastIndexOf=function(list,item,from){var idx;for(idx="number"==typeof from?0>from?list.length+from:Math.min(list.length-1,from):list.length-1;idx>=0;){if(equals(list[idx],item))return idx;idx-=1}return-1},_pluck=function(p,list){return map(prop(p),list)},_predicateWrap=function(predPicker){return function(preds){var predIterator=function(){var args=arguments;return predPicker(function(predicate){return predicate.apply(null,args)},preds)};return arguments.length>1?predIterator.apply(null,_slice(arguments,1)):arity(max(_pluck("length",preds)),predIterator)}},_stepCat=function(){var _stepCatArray={"@@transducer/init":Array,"@@transducer/step":function(xs,x){return _concat(xs,[x])},"@@transducer/result":_identity},_stepCatString={"@@transducer/init":String,"@@transducer/step":_add,"@@transducer/result":_identity},_stepCatObject={"@@transducer/init":Object,"@@transducer/step":function(result,input){return merge(result,isArrayLike(input)?_createMapEntry(input[0],input[1]):input)},"@@transducer/result":_identity};return function(obj){if(_isTransformer(obj))return obj;if(isArrayLike(obj))return _stepCatArray;if("string"==typeof obj)return _stepCatString;if("object"==typeof obj)return _stepCatObject;throw new Error("Cannot create transformer for "+obj)}}(),_toString=function _toString(x,seen){var recur=function(y){var xs=seen.concat([x]);return _indexOf(xs,y)>=0?"<Circular>":_toString(y,xs)};switch(Object.prototype.toString.call(x)){case"[object Arguments]":return"(function() { return arguments; }("+_map(recur,x).join(", ")+"))";case"[object Array]":return"["+_map(recur,x).join(", ")+"]";case"[object Boolean]":return"object"==typeof x?"new Boolean("+recur(x.valueOf())+")":x.toString();case"[object Date]":return"new Date("+_quote(_toISOString(x))+")";case"[object Null]":return"null";case"[object Number]":return"object"==typeof x?"new Number("+recur(x.valueOf())+")":1/x===-(1/0)?"-0":x.toString(10);case"[object String]":return"object"==typeof x?"new String("+recur(x.valueOf())+")":_quote(x);case"[object Undefined]":return"undefined";default:return"function"==typeof x.constructor&&"Object"!==x.constructor.name&&"function"==typeof x.toString&&"[object Object]"!==x.toString()?x.toString():"{"+_map(function(k){return _quote(k)+": "+recur(x[k])},keys(x).sort()).join(", ")+"}"}},_xchain=_curry2(function(f,xf){return map(f,_flatCat(xf))}),addIndex=_curry1(function(fn){return curryN(fn.length,function(){var idx=0,origFn=arguments[0],list=arguments[arguments.length-1],indexedFn=function(){var result=origFn.apply(this,_concat(arguments,[idx,list]));return idx+=1,result};return fn.apply(this,_prepend(indexedFn,_slice(arguments,1)))})}),ap=_curry2(function(fns,vs){return _hasMethod("ap",fns)?fns.ap(vs):_reduce(function(acc,fn){return _concat(acc,map(fn,vs))},[],fns)}),chain=_curry2(_dispatchable("chain",_xchain,_chain)),commuteMap=_curry3(function(fn,of,list){function consF(acc,ftor){return ap(map(append,fn(ftor)),acc)}return _reduce(consF,of([]),list)}),curry=_curry1(function(fn){return curryN(fn.length,fn)}),drop=_curry2(_dispatchable("drop",_xdrop,function(n,xs){return slice(Math.max(0,n),1/0,xs)})),dropRepeatsWith=_curry2(_dispatchable("dropRepeatsWith",_xdropRepeatsWith,function(pred,list){var result=[],idx=1,len=list.length;if(0!==len)for(result[0]=list[0];len>idx;)pred(last(result),list[idx])||(result[result.length]=list[idx]),idx+=1;return result})),eqDeep=equals,eqProps=_curry3(function(prop,obj1,obj2){return equals(obj1[prop],obj2[prop])}),flip=_curry1(function(fn){return curry(function(a,b){var args=_slice(arguments);return args[0]=b,args[1]=a,fn.apply(this,args)})}),indexOf=_curry2(function(target,xs){return _hasMethod("indexOf",xs)?xs.indexOf(target):_indexOf(xs,target)}),init=slice(0,-1),into=_curry3(function(acc,xf,list){return _isTransformer(acc)?_reduce(xf(acc),acc["@@transducer/init"](),list):_reduce(xf(_stepCat(acc)),acc,list)}),invoke=curry(function(methodName,args,obj){return obj[methodName].apply(obj,args)}),isSet=_curry1(function(list){for(var len=list.length,idx=0;len>idx;){if(_indexOf(list,list[idx],idx+1)>=0)return!1;idx+=1}return!0}),lastIndexOf=_curry2(function(target,xs){return _hasMethod("lastIndexOf",xs)?xs.lastIndexOf(target):_lastIndexOf(xs,target)}),liftN=_curry2(function(arity,fn){var lifted=curryN(arity,fn);return curryN(arity,function(){return _reduce(ap,map(lifted,arguments[0]),_slice(arguments,1))})}),mean=_curry1(function(list){return sum(list)/list.length}),median=_curry1(function(list){var len=list.length;if(0===len)return 0/0;var width=2-len%2,idx=(len-width)/2;return mean(_slice(list).sort(function(a,b){return b>a?-1:a>b?1:0}).slice(idx,idx+width))}),mergeAll=_curry1(function(list){return reduce(merge,{},list)}),omit=_curry2(function(names,obj){var result={};for(var prop in obj)_indexOf(names,prop)<0&&(result[prop]=obj[prop]);return result}),partial=curry(_createPartialApplicator(_concat)),partialRight=curry(_createPartialApplicator(flip(_concat))),pluck=_curry2(_pluck),product=reduce(_multiply,1),toString=_curry1(function(val){return _toString(val,[])}),union=_curry2(compose(uniq,_concat)),useWith=curry(function(fn){var transformers=_slice(arguments,1),tlen=transformers.length;return curry(arity(tlen,function(){for(var args=[],idx=0;tlen>idx;)args[idx]=transformers[idx](arguments[idx]),idx+=1;return fn.apply(this,args.concat(_slice(arguments,tlen)))}))}),_contains=function(a,list){return _indexOf(list,a)>=0},allPass=curry(_predicateWrap(_all)),anyPass=curry(_predicateWrap(_any)),call=curry(function(fn){return fn.apply(this,_slice(arguments,1))}),commute=commuteMap(map(identity)),constructN=_curry2(function(n,Fn){if(n>10)throw new Error("Constructor with greater than ten arguments");return 0===n?function(){return new Fn}:curry(nAry(n,function($0,$1,$2,$3,$4,$5,$6,$7,$8,$9){switch(arguments.length){case 1:return new Fn($0);case 2:return new Fn($0,$1);case 3:return new Fn($0,$1,$2);case 4:return new Fn($0,$1,$2,$3);case 5:return new Fn($0,$1,$2,$3,$4);case 6:return new Fn($0,$1,$2,$3,$4,$5);case 7:return new Fn($0,$1,$2,$3,$4,$5,$6);case 8:return new Fn($0,$1,$2,$3,$4,$5,$6,$7);case 9:return new Fn($0,$1,$2,$3,$4,$5,$6,$7,$8);case 10:return new Fn($0,$1,$2,$3,$4,$5,$6,$7,$8,$9)}}))}),contains=_curry2(_contains),converge=curryN(3,function(after){var fns=_slice(arguments,1);return curryN(max(pluck("length",fns)),function(){var args=arguments,context=this;return after.apply(context,_map(function(fn){return fn.apply(context,args)},fns))})}),difference=_curry2(function(first,second){for(var out=[],idx=0,firstLen=first.length;firstLen>idx;)_contains(first[idx],second)||_contains(first[idx],out)||(out[out.length]=first[idx]),idx+=1;return out}),dropRepeats=_curry1(_dispatchable("dropRepeats",_xdropRepeatsWith(equals),dropRepeatsWith(equals))),intersection=_curry2(function(list1,list2){return uniq(_filter(flip(_contains)(list1),list2))}),lift=_curry1(function(fn){return liftN(fn.length,fn)}),memoize=_curry1(function(fn){var cache={};return function(){var key=toString(arguments);return _has(key,cache)||(cache[key]=fn.apply(this,arguments)),cache[key]}}),project=useWith(_map,pickAll,identity),construct=_curry1(function(Fn){return constructN(Fn.length,Fn)}),R={F:F,T:T,__:__,add:add,addIndex:addIndex,adjust:adjust,all:all,allPass:allPass,always:always,and:and,any:any,anyPass:anyPass,ap:ap,aperture:aperture,append:append,apply:apply,arity:arity,assoc:assoc,assocPath:assocPath,binary:binary,bind:bind,both:both,call:call,chain:chain,clone:clone,commute:commute,commuteMap:commuteMap,comparator:comparator,complement:complement,compose:compose,composeL:composeL,composeP:composeP,concat:concat,cond:cond,construct:construct,constructN:constructN,contains:contains,containsWith:containsWith,converge:converge,countBy:countBy,createMapEntry:createMapEntry,curry:curry,curryN:curryN,dec:dec,defaultTo:defaultTo,difference:difference,differenceWith:differenceWith,dissoc:dissoc,dissocPath:dissocPath,divide:divide,drop:drop,dropRepeats:dropRepeats,dropRepeatsWith:dropRepeatsWith,dropWhile:dropWhile,either:either,empty:empty,eq:eq,eqDeep:eqDeep,eqProps:eqProps,equals:equals,evolve:evolve,filter:filter,filterIndexed:filterIndexed,find:find,findIndex:findIndex,findLast:findLast,findLastIndex:findLastIndex,flatten:flatten,flip:flip,forEach:forEach,forEachIndexed:forEachIndexed,fromPairs:fromPairs,functions:functions,functionsIn:functionsIn,groupBy:groupBy,gt:gt,gte:gte,has:has,hasIn:hasIn,head:head,identical:identical,identity:identity,ifElse:ifElse,inc:inc,indexOf:indexOf,init:init,insert:insert,insertAll:insertAll,intersection:intersection,intersectionWith:intersectionWith,intersperse:intersperse,into:into,invert:invert,invertObj:invertObj,invoke:invoke,invoker:invoker,is:is,isArrayLike:isArrayLike,isEmpty:isEmpty,isNil:isNil,isSet:isSet,join:join,keys:keys,keysIn:keysIn,last:last,lastIndexOf:lastIndexOf,length:length,lens:lens,lensIndex:lensIndex,lensOn:lensOn,lensProp:lensProp,lift:lift,liftN:liftN,lt:lt,lte:lte,map:map,mapAccum:mapAccum,mapAccumRight:mapAccumRight,mapIndexed:mapIndexed,mapObj:mapObj,mapObjIndexed:mapObjIndexed,match:match,mathMod:mathMod,max:max,maxBy:maxBy,mean:mean,median:median,memoize:memoize,merge:merge,mergeAll:mergeAll,min:min,minBy:minBy,modulo:modulo,multiply:multiply,nAry:nAry,negate:negate,none:none,not:not,nth:nth,nthArg:nthArg,nthChar:nthChar,nthCharCode:nthCharCode,of:of,omit:omit,once:once,or:or,partial:partial,partialRight:partialRight,partition:partition,path:path,pathEq:pathEq,pick:pick,pickAll:pickAll,pickBy:pickBy,pipe:pipe,pipeL:pipeL,pipeP:pipeP,pluck:pluck,prepend:prepend,product:product,project:project,prop:prop,propEq:propEq,propOr:propOr,props:props,range:range,reduce:reduce,reduceIndexed:reduceIndexed,reduceRight:reduceRight,reduceRightIndexed:reduceRightIndexed,reduced:reduced,reject:reject,rejectIndexed:rejectIndexed,remove:remove,repeat:repeat,replace:replace,reverse:reverse,scan:scan,slice:slice,sort:sort,sortBy:sortBy,split:split,strIndexOf:strIndexOf,strLastIndexOf:strLastIndexOf,substring:substring,substringFrom:substringFrom,substringTo:substringTo,subtract:subtract,sum:sum,tail:tail,take:take,takeWhile:takeWhile,tap:tap,test:test,times:times,toLower:toLower,toPairs:toPairs,toPairsIn:toPairsIn,toString:toString,toUpper:toUpper,transduce:transduce,trim:trim,type:type,unapply:unapply,unary:unary,uncurryN:uncurryN,unfold:unfold,union:union,unionWith:unionWith,uniq:uniq,uniqWith:uniqWith,unnest:unnest,update:update,useWith:useWith,values:values,valuesIn:valuesIn,where:where,whereEq:whereEq,wrap:wrap,xprod:xprod,zip:zip,zipObj:zipObj,zipWith:zipWith};"object"==typeof exports?module.exports=R:"function"==typeof define&&define.amd?define(function(){return R}):this.R=R}).call(this)},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/config.js":[function(require,module,exports){"use strict";module.exports=["$stateProvider",function($stateProvider){$stateProvider.state("activities",{parent:"app",url:"/activities",templateUrl:"activities.html"})}]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/controller.js":[function(require,module,exports){"use strict";module.exports=function(){}},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/module.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.activities",[require("./sentences/module.js").name,require("./proofreadings/module.js").name]).config(require("./config.js")).controller("activities",require("./controller.js"))},{"./config.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/config.js","./controller.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/controller.js","./proofreadings/module.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/proofreadings/module.js","./sentences/module.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/sentences/module.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/proofreadings/config.js":[function(require,module,exports){"use strict";module.exports=["$stateProvider",function($stateProvider){$stateProvider.state("proofreadings",{parent:"activities",controller:"ProofreadingsCtrl",url:"/proofreadings",template:"<div ui-view></div>"}).state("proofreadings.list",{url:"/list",templateUrl:"proofreadings.list.html"})}]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/proofreadings/controller.js":[function(require,module,exports){"use strict";module.exports=["$scope","ProofreadingService",function($scope,ProofreadingService){ProofreadingService.getAllProofreadings().then(function(prfs){$scope.proofreadings=prfs})}]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/proofreadings/module.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.activities.proofreadings",[require("./../../../services/proofreading.js").name]).config(require("./config.js")).controller("ProofreadingsCtrl",require("./controller.js"))},{"./../../../services/proofreading.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/proofreading.js","./config.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/proofreadings/config.js","./controller.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/proofreadings/controller.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/sentences/config.js":[function(require,module,exports){"use strict";module.exports=["$stateProvider",function($stateProvider){$stateProvider.state("sentences",{parent:"activities",controller:"SentencesCtrl",url:"/sentences",template:"<div ui-view></div>"}).state("sentences.list",{url:"/list",templateUrl:"sentences.list.html"}).state("sentences.edit",{url:"/edit/:id",require:"^SentencesCtrl",controller:"EditSentenceCtrl",templateUrl:"sentences.edit.html"}).state("sentences.new",{url:"/new",templateUrl:"sentences.new.html"}).state("sentences.new.details",{parent:"sentences.new",url:"/details?uid",templateUrl:"sentences.new.details.html"}).state("sentences.new.questions",{parent:"sentences.new",url:"/questions?uid",templateUrl:"sentences.new.questions.html"})}]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/sentences/controller.js":[function(require,module,exports){"use strict";module.exports=["$scope","CategoryService","$state","RuleService","SentenceWritingService","FlagService","_","$timeout",function($scope,CategoryService,$state,RuleService,SentenceWritingService,FlagService,_,$timeout){function clearError(){$scope.error=null}function setError(msg){$scope.error=msg,$timeout(clearError,5e3)}$scope.newSentence={},FlagService.getFlags().then(function(flags){$scope.flags=flags}),SentenceWritingService.getAllSentenceWritings().then(function(ss){$scope.sentences=ss}),CategoryService.getCategories().then(function(cats){$scope.availableCategories=cats}),RuleService.getAllRules().then(function(rules){$scope.availableRules=rules}),$scope.nextStep=function(){$state.go("^.questions",{uid:$state.params.uid})},$scope.addRule=function(s,r){try{if(s.rules||(s.rules=[]),_.find(s.rules,r))throw new Error("Cannot have two instances of the same rule "+r.title);r&&s.rules.push(r)}catch(e){setError(e.message)}},$scope.removeRule=function(s,r){s&&(s.rules=_.without(s.rules,r))},$scope.submitSentence=function(stateString,s,edit){function handleResult(){$scope.newSentence={},$state.go(stateString)}function handlerError(e){console.error(e),setError(e.message||e)}try{var allPositiveQuantities=_.every(s.rules,function(r){return Number(r.quantity)>0});if(!allPositiveQuantities)throw new Error("Please make all rules have a quanity greater than zero");var p=null;return edit?p=SentenceWritingService.updateSentenceWriting(s):$state.params.uid?(s.$id=$state.params.uid,p=SentenceWritingService.saveSentenceWritingWithId(s)):p=SentenceWritingService.saveSentenceWriting(s),p.then(handleResult,handlerError)}catch(e){setError(e.message)}}}]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/sentences/editSentence.js":[function(require,module,exports){"use strict";module.exports=["$scope","SentenceWritingService","$state","_","FlagService",function($scope,SentenceWritingService,$state,_,FlagService){var flagPromise=FlagService.getFlags();SentenceWritingService.getSentenceWriting($state.params.id).then(function(s){s.oldCategoryId=_.clone(s.categoryId),s.category=_.first(_.filter($scope.availableCategories,function(o){return o.$id===s.categoryId}));var tempList=_.chain(s.rules).pluck("ruleId").toArray().map(function(s){return String(s)}).value();s.rules=_.chain($scope.availableRules).filter(function(r){
return _.contains(tempList,String(r.$id))}).map(function(r){return r.quantity=_.findWhere(s.rules,{ruleId:r.$id}).quantity,r}).value(),flagPromise.then(function(flags){$scope.flags=flags,s.flag=_.first(_.filter($scope.flags,function(f){return f.$id===s.flagId}))}),$scope.editSentence=s})}]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/sentences/module.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.activities.sentences",[require("./../../../services/sentenceWriting.js").name,require("./../../../services/flag.js").name]).config(require("./config.js")).controller("EditSentenceCtrl",require("./editSentence.js")).controller("SentencesCtrl",require("./controller.js"))},{"./../../../services/flag.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/flag.js","./../../../services/sentenceWriting.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/sentenceWriting.js","./config.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/sentences/config.js","./controller.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/sentences/controller.js","./editSentence.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/activities/sentences/editSentence.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/app.config.js":[function(require,module,exports){"use strict";module.exports=["$urlRouterProvider","$locationProvider",function($urlRouterProvider,$locationProvider){$urlRouterProvider.otherwise("/"),$locationProvider.html5Mode({enabled:!0})}]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/cms/cms.config.js":[function(require,module,exports){"use strict";module.exports=["$stateProvider",function($stateProvider){$stateProvider.state("cms",{parent:"app",url:"/cms",templateUrl:"cms.html",controller:"cms"})}]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/cms/cms.controller.js":[function(require,module,exports){"use strict";module.exports=function(){}},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/cms/cms.module.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.cms",[require("./../../directives/grammarCMS").name,require("./../../filters/").name]).config(require("./cms.config.js")).controller("cms",require("./cms.controller.js"))},{"./../../directives/grammarCMS":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/index.js","./../../filters/":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/filters/index.js","./cms.config.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/cms/cms.config.js","./cms.controller.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/cms/cms.controller.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/core/core.module.js":[function(require,module,exports){"use strict";require("ng-autofocus/autofocus"),module.exports=angular.module("quill-grammar.core",["ui.router","LocalStorageModule","autofocus","duScroll","angulartics","angulartics.mixpanel",require("../../../../.tmp/config").name,require("../../../../.tmp/templates").name,require("../../directives/index.js").name,require("../../services/auth").name]).config(["$analyticsProvider",function($analyticsProvider){$analyticsProvider.virtualPageviews(!1)}]).run(require("./core.run.js"))},{"../../../../.tmp/config":"/home/will/Clients/Quill/Quill-Grammar/.tmp/config.js","../../../../.tmp/templates":"/home/will/Clients/Quill/Quill-Grammar/.tmp/templates.js","../../directives/index.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/index.js","../../services/auth":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/auth/index.js","./core.run.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/core/core.run.js","ng-autofocus/autofocus":"/home/will/Clients/Quill/Quill-Grammar/node_modules/ng-autofocus/autofocus.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/core/core.run.js":[function(require,module,exports){"use strict";module.exports=["QuillFirebaseAuthService","QuillOAuthService","$rootScope",function(QuillFirebaseAuthService,QuillOAuthService,$rootScope){QuillFirebaseAuthService.authenticate(),$rootScope.$on("$stateChangeStart",function(event,state,params){if(state.data&&state.data.authenticateUser){var isAnonymous="anonymous"in params&&"true"===params.anonymous;isAnonymous||(QuillOAuthService.watchForExpiration(state,params),QuillOAuthService.isAuthenticated()||QuillOAuthService.authenticate(state,params))}})}]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/index/index.config.js":[function(require,module,exports){"use strict";module.exports=["$stateProvider",function($stateProvider){$stateProvider.state("index",{parent:"app",url:"/",templateUrl:"index.html",controller:"index as ind"})}]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/index/index.controller.js":[function(require,module,exports){"use strict";module.exports=["$scope","RuleQuestionService",function($scope,RuleQuestionService){RuleQuestionService._getAllRuleQuestionsWithInstructions().then(function(questions){var i=0;$scope.showNextQuestion=!1,$scope.showPreviousQuestion=!1,$scope.currentRuleQuestion=questions[i],$scope.nextQuestion=function(){$scope.currentRuleQuestion=questions[++i]},$scope.previousQuestion=function(){$scope.currentRuleQuestion=questions[--i]},$scope.$watch("currentRuleQuestion",function(){$scope.currentRuleQuestion||$scope.finish(),$scope.showNextQuestion=i<questions.length&&$scope.currentRuleQuestion&&$scope.currentRuleQuestion.correct,$scope.showPreviousQuestion=i>0},!0),$scope.finish=function(){console.log(i),console.log("Thanks for playing"),$scope.showNextQuestion=!1,$scope.showPreviousQuestion=!1}})}]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/index/index.module.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.index",[require("./../../directives/grammarElements/ruleQuestion/").name,require("./../../services/ruleQuestion.js").name]).config(require("./index.config.js")).controller("index",require("./index.controller.js"))},{"./../../directives/grammarElements/ruleQuestion/":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarElements/ruleQuestion/index.js","./../../services/ruleQuestion.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/ruleQuestion.js","./index.config.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/index/index.config.js","./index.controller.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/index/index.controller.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/layout/layout.config.js":[function(require,module,exports){"use strict";module.exports=["$stateProvider",function($stateProvider){$stateProvider.state("app",{url:"","abstract":!0,templateUrl:"layout.html"})}]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/layout/layout.module.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.layout",["ui.router"]).config(require("./layout.config.js"))},{"./layout.config.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/layout/layout.config.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/directives/index.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.play.directives",[require("./proofreader-sample-result/").name])},{"./proofreader-sample-result/":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/directives/proofreader-sample-result/index.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/directives/proofreader-sample-result/index.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.play.directives.proofreader",[]).directive("proofreaderSampleResult",function(){return{restrict:"E",templateUrl:"proofreader-sample-result.html",scope:{uid:"="},controller:"ProofreadingDirCtrl"}}).directive("proofreadingResultLargeFlag",function(){return{restrict:"E",templateUrl:"proofreader-result-large-flag.html",scope:{uid:"="},controller:"ProofreadingDirCtrl"}}).controller("ProofreadingDirCtrl",["$scope","localStorageService","_",function($scope,localStorageService,_){function getTotals(set){var correct=0,total=0;return _.isArray(set)&&_.each(set,function(s){if(!_.isNumber(s.correct)||!_.isNumber(s.total))throw new Error("incorrect object sent to getTotals iterator");correct+=s.correct,total+=s.total}),{correct:correct,total:total}}function totalRanking(totals){if(!_.isNumber(totals.correct)||!_.isNumber(totals.total))throw new Error("incorrect object sent to totalRanking");if(0!==totals.total){var score=totals.correct/totals.total*100;return _.chain($scope.rankings).sortBy(function(r){return r.threshold}).reject(function(r){return score<r.threshold}).last().value()}return $scope.rankings.not_proficient}var pfResults=localStorageService.get("pf-"+$scope.uid),swResults=localStorageService.get("sw-"+$scope.uid),pfTotals=getTotals(pfResults),swTotals=getTotals(swResults),totals={correct:pfTotals.correct+swTotals.correct,total:pfTotals.total+swTotals.total};if($scope.rankings={at_proficiency:{title:"At Proficiency",threshold:75,"class":"at-proficiency"},near_proficiency:{title:"Near Proficiency",threshold:50,"class":"near-proficiency"},not_proficient:{title:"Not Proficient",threshold:0,"class":"not-proficient"}},totals.total>0){var rankObj=totalRanking(totals);$scope.ranking=rankObj.title,$scope.score=String(totals.correct)+"/"+String(totals.total),$scope.rankingClass={},$scope.rankingClass[rankObj["class"]]=!0}}])},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/proofreadings/config.js":[function(require,module,exports){"use strict";module.exports=["$stateProvider",function($stateProvider){$stateProvider.state("play-pf",{parent:"app",templateUrl:"proofreadings.play.html",controller:"ProofreadingPlayCtrl",url:"/play/pf?uid&student&anonymous",data:{authenticateUser:!0}})}]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/proofreadings/controller.js":[function(require,module,exports){"use strict";module.exports=["$scope","$state","ProofreadingService","RuleService","_","$location","localStorageService","$document","$timeout","$analytics",function($scope,$state,ProofreadingService,RuleService,_,$location,localStorageService,$document,$timeout,$analytics){function error(){console.error(arguments[0].stack),$state.go("index")}function fetchListedRules(){var ruleIds=_.pluck($scope.passageQuestions,"ruleNumber");RuleService.getRules(ruleIds).then(function(rules){$scope.referencedRules=rules})}function getNumCorrect(results){return _.where(results,{type:$scope.CORRECT}).length}function getNumResults(){return _.keys($scope.results).length}function showModalNotEnoughFound(needed){$scope.pf.modal={title:"Keep Trying!",message:"You must make at least "+needed+" edits.",buttonMessage:"Find Edits",buttonClick:function(){$scope.pf.modal.show=!1},show:!0}}function showResultsModal(results,numErrorsFound,numErrorsToSolve){function createTitle(){return numErrorsFound===numErrorsToSolve?"Congratulations!":numErrorsFound>=numErrorsToSolve/2?"Good Work!":""}var nf=numErrorsFound===numErrorsToSolve?"all "+String(numErrorsFound):String(numErrorsFound)+" of "+String(numErrorsToSolve),title=createTitle();$scope.pf.modal={title:title,message:"You found "+nf+" errors.",buttonMessage:"Review Your Work",buttonClick:function(){$scope.pf.modal.show=!1,showResults(results)},show:!0}}function calculateTop(sIndex){var breakIndexes=_.chain($scope.pf.passage).map(function(word,index){return[index,$scope.isBr(word.responseText)]}).filter(function(v){return v[1]}).map(function(v){return v[0]}).sortBy(function(num){return num}).value(),indexWithOutGoingOver=_.find(breakIndexes,function(i){return i>=sIndex}),scrollId="last-chance-tooltip-breakpoint-at-panel";indexWithOutGoingOver&&(scrollId="break-binding-point-"+String(indexWithOutGoingOver));var elem=document.getElementById(scrollId),top=getAbsPosition(elem)[0];return String(top)+"px"}function showResults(passageResults){_.each(passageResults,function(pr,i){$scope.pf.passage[pr.index].type=pr.type,$scope.pf.passage[pr.index].resultIndex=i,$scope.pf.passage[pr.index].ruleNumber=pr.passageEntry.ruleNumber,$scope.pf.passage[pr.index].totalResults=passageResults.length,$scope.pf.passage[pr.index].nextAction=$scope.nextAction($scope.pf.passage[pr.index],pr.index)});var ruleNumbers=_.chain(passageResults).pluck("passageEntry").reject(function(r){return r.type!==$scope.INCORRECT_ERROR}).pluck("ruleNumber").reject(_.isUndefined).uniq().value();generateLesson(ruleNumbers),$scope.focusResult(0,passageResults[0].index),sendResultsAnalytics(passageResults),saveResults(getLocalResults(passageResults)),$scope.pf.passage.submitted=!0}function saveResults(r){localStorageService.set("pf-"+$scope.id,r),localStorageService.remove("sw-"+$scope.id),localStorageService.remove("sw-temp-"+$scope.id)}function sendResultsAnalytics(results){var event="Press Check Answer",passageResults=_.chain(results).pluck("passageEntry").map(function(p){return _.pick(p,["minus","ruleNumber","responseText","plus","type"])}).value(),correct=_.filter(passageResults,function(pr){return pr.type===$scope.CORRECT}),incorrect=_.filter(passageResults,function(pr){return pr.type!==$scope.CORRECT}),correctWords=_.map(correct,function(c){return c.responseText}),incorrectWords=_.map(incorrect,function(i){return i.responseText}),correctRuleNumbers=_.map(correct,function(c){return c.ruleNumber}),incorrectRuleNumbers=_.map(incorrect,function(i){return i.ruleNumber}),attrs={correct:correct,incorrect:incorrect,correctWords:correctWords,correctRuleNumbers:correctRuleNumbers,incorrectRuleNumbers:incorrectRuleNumbers,incorrectWords:incorrectWords,score:100*Number(correct.length/results.length)};$analytics.eventTrack(event,attrs)}function getLocalResults(passageResults){var rules=$scope.referencedRules;return _.chain(passageResults).pluck("passageEntry").reject(function(pe){return _.isUndefined(pe.ruleNumber)}).map(function(pe){var rule=_.findWhere(rules,{ruleNumber:Number(pe.ruleNumber)});return{title:rule.title,correct:pe.type===$scope.CORRECT}}).groupBy("title").map(function(entries,title){return{conceptClass:title,total:entries.length,correct:_.filter(entries,function(v){return v.correct}).length}}).value()}function generateLesson(ruleNumbers){$scope.goToLesson=function(){$state.go("play-sw-gen",{ids:ruleNumbers,passageId:$scope.id,student:$state.params.student})},$scope.hasLesson=!0}$scope.id=$state.params.uid,$scope.obscure=function(key){return btoa(key)},$scope.ubObscure=function(o){return atob(o)},ProofreadingService.getProofreading($scope.id).then(function(pf){pf.passage=ProofreadingService.prepareProofreading(pf.passage,$scope),$scope.pf=pf,fetchListedRules()},error),$scope.numChanges=0,$scope.madeChange=!1,$scope.onInputChange=function(word){var nc=$scope.numChanges;""===word.responseText?word.countedChange||(nc++,word.countedChange=!0):word.responseText!==word.text?(word.countedChange||nc++,word.countedChange=!0):word.responseText===word.text&&word.countedChange&&(nc=Math.max(nc-1,0),word.countedChange=!1),$scope.numChanges=nc,!$scope.madeChange&&nc>0&&($scope.madeChange=!0,$analytics.eventTrack("Edit One Passage Word",word))},$scope.getRuleInfoBy=function(ruleNumber){return _.findWhere($scope.referencedRules,{ruleNumber:Number(ruleNumber)}).title},$scope.INCORRECT_ERROR="Incorrect",$scope.NOT_NECESSARY_ERROR="Not Necessary",$scope.CORRECT="Correct",$scope.hasNotNecessaryError=function(word){return word.type===$scope.NOT_NECESSARY_ERROR},$scope.hasIncorrectError=function(word){return word.type===$scope.INCORRECT_ERROR},$scope.hasCorrect=function(word){return word.type===$scope.CORRECT},$scope.submitPassage=function(){function isValid(passageEntry){return _.has(passageEntry,"minus")?passageEntry.responseText===passageEntry.plus:passageEntry.text===passageEntry.responseText}function getErrorType(passageEntry){return _.has(passageEntry,"minus")?$scope.INCORRECT_ERROR:$scope.NOT_NECESSARY_ERROR}var passage=$scope.pf.passage;$scope.results=[],_.each(passage,function(p,i){isValid(p)||$scope.results.push({index:i,passageEntry:p,type:getErrorType(p)}),isValid(p)&&_.has(p,"minus")&&$scope.results.push({index:i,passageEntry:p,type:$scope.CORRECT})});var numErrors=_.keys($scope.passageQuestions).length,numErrorsToSolve=Math.floor(numErrors/2),numErrorsFound=getNumCorrect($scope.results),numEdits=$scope.numChanges;numErrorsFound>=numErrorsToSolve||numEdits>=numErrorsToSolve?showResultsModal($scope.results,numErrorsFound,numErrors):showModalNotEnoughFound(numErrorsToSolve)},$scope.getNumErrors=function(){return _.keys($scope.passageQuestions).length},$scope.nextAction=function(word,index){if(!$scope.results)return{};var allCorrect=getNumCorrect($scope.results)===$scope.getNumErrors(),na={fn:null,title:""};return word.resultIndex+1>=getNumResults()?allCorrect?(na.fn=function(){$state.go("play-sw-gen",{ids:[],passageId:$scope.id,pfAllCorrect:!0,student:$state.params.student})},na.title="View Results"):(na.fn=function(){$scope.goToLesson()},na.title="Start My Activity"):(na.fn=function(){$scope.focusResult(word.resultIndex+1,index)},na.title="Next Edit"),na};var getAbsPosition=function(el){var el2=el,curtop=0,curleft=0;if(document.getElementById||document.all){do for(curleft+=el.offsetLeft-el.scrollLeft,curtop+=el.offsetTop-el.scrollTop,el=el.offsetParent,el2=el2.parentNode;el2!==el;)curleft-=el2.scrollLeft,curtop-=el2.scrollTop,el2=el2.parentNode;while(el.offsetParent)}else document.layers&&(curtop+=el.y,curleft+=el.x);return[curtop,curleft]};$scope.focusResult=function(resultIndex,scrollIndex){var p=$scope.results[resultIndex-1],r=$scope.results[resultIndex];p&&($scope.pf.passage[p.index].tooltip={}),r&&($scope.pf.passage[r.index].tooltip={style:{visibility:"visible",opacity:1,top:calculateTop(r.index)}});var scrollTo=r.index;if(scrollTo||(scrollTo=scrollIndex),String(scrollTo)){var scrollId="error-tooltip-scroll-"+String(scrollTo),elem=angular.element(document.getElementById(scrollId));$document.scrollToElement(elem)}},$scope.getErrorTooltipClass=function(index){var d=($scope.$parent.results,{"error-tooltip-reverse":!0});return d},$scope.getErrorTooltipTopClass=function(type){var obj={"top-panel":!0};return obj[type]=!0,obj},$scope.errorCounter=function(word){return"Edit "+String(word.resultIndex+1)+" of "+word.totalResults},$scope.answerImageName=function(t){return t?_.map(t.split(" "),function(s){return s.toLowerCase()}).join("_"):void 0},$scope.needsUnderlining=function(p){return $scope.pf&&$scope.pf.underlineErrorsInProofreader&&_.has(p,"minus")?!0:void 0},$scope.isBr=function(text){return null!==ProofreadingService.htmlMatches(text)},$scope.hasErrorToShow=function(word){return _.any([$scope.hasNotNecessaryError,$scope.hasCorrect,$scope.hasIncorrectError],function(fn){return fn(word)})},$scope.getGrammaticalConceptForWord=function(word){if(word.ruleNumber){var rule=_.findWhere($scope.referencedRules,{ruleNumber:Number(word.ruleNumber)});if(rule&&rule.title)return rule.title}}}]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/proofreadings/module.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.play.proofreadings",[require("./../../layout/layout.module.js").name,require("./../directives/").name,require("./../../../services/proofreading.js").name,require("./../../../services/category.js").name,require("./../../../services/finalize.js").name,"LocalStorageModule","angulartics","angular.filter","ui.router","uuid4"]).config(require("./config.js")).filter("passageProofreadingFormatter",require("./passageFormatter.js")).directive("quillGrammarPassage",function(){return{restrict:"E",controller:"ProofreadingPlayCtrl",scope:{passage:"=",numChanges:"="},templateUrl:"passage.html"}}).directive("quillGrammarPfHeading",function(){return{restrict:"E",controller:"ProofreadingPlayCtrl",scope:{pf:"=",numChanges:"="},templateUrl:"pf-heading.html"}}).directive("quillGrammarPassageSubmitPanel",function(){return{restrict:"E",controller:"ProofreadingPlayCtrl",templateUrl:"pf-submit-panel.html"}}).directive("ngSize",require("./ngSize.js")).controller("ProofreadingPlayCtrl",require("./controller.js"))},{"./../../../services/category.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/category.js","./../../../services/finalize.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/finalize.js","./../../../services/proofreading.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/proofreading.js","./../../layout/layout.module.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/layout/layout.module.js","./../directives/":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/directives/index.js","./config.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/proofreadings/config.js","./controller.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/proofreadings/controller.js","./ngSize.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/proofreadings/ngSize.js","./passageFormatter.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/proofreadings/passageFormatter.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/proofreadings/ngSize.js":[function(require,module,exports){"use strict";module.exports=function(){return{restrict:"A",link:function(scope,element,attrs){attrs.$observe("ngSize",function(){var size=0===Number(attrs.ngSize)?1:Number(attrs.ngSize);attrs.$set("size",size)})}}}},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/proofreadings/passageFormatter.js":[function(require,module,exports){"use strict";module.exports=function(){return function(input){return input}}},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/sentences/config.js":[function(require,module,exports){"use strict";module.exports=["$stateProvider",function($stateProvider){$stateProvider.state("play-sw",{parent:"app",templateUrl:"sentences.play.html",controller:"SentencePlayCtrl",url:"/play/sw?uid&student",data:{authenticateUser:!0}}).state("play-sw.results",{parent:"app",templateUrl:"sentences.results.html",controller:"ResultsController",url:"/play/sw/results?uid&student"}).state("play-sw-gen.results",{parent:"app",templateUrl:"sentences.results.html",controller:"ResultsController",url:"/play/sw/gen-results?passageId"}).state("play-sw-gen",{parent:"app",templateUrl:"sentences.play.html",controller:"SentencePlayCtrl",url:"/play/sw/g/:ids?student&passageId&pfAllCorrect"})}]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/sentences/controller.js":[function(require,module,exports){"use strict";module.exports=["$scope","$state","SentenceWritingService","RuleService","_","ConceptTagResult","ActivitySession","SentenceLocalStorage","$analytics","AnalyticsService","finalizeService",function($scope,$state,SentenceWritingService,RuleService,_,ConceptTagResult,ActivitySession,SentenceLocalStorage,$analytics,AnalyticsService,finalizeService){function errorStateChange(){$state.go("index")}function retrieveNecessaryRules(ruleIds,quantities){RuleService.getRules(ruleIds).then(function(resolvedRules){$scope.swSet=_.chain(resolvedRules).map(function(rr,i){return rr.selectedRuleQuestions=_.chain(rr.resolvedRuleQuestions).sample(quantities[i]).map(function(rrq){return rrq.ruleIndex=i,rrq}).value(),rr}).value(),$scope.questions=_.chain($scope.swSet).pluck("selectedRuleQuestions").flatten().value(),$scope.currentRuleQuestion=$scope.questions[0],$scope.showNextQuestion=!1,$scope.showPreviousQuestion=!1},function(){})}if($scope.$watch("currentRuleQuestion",function(crq){_.isObject(crq)&&($scope.currentRule=$scope.swSet[crq.ruleIndex])}),$scope.number=0,$scope.numAttempts=2,$scope.$on("answerRuleQuestion",function(e,crq,answer,correct){if(!answer||!crq)throw new Error("We need a rule question and answer");if($scope.sessionId&&ConceptTagResult.save($scope.sessionId,{concept_tag:crq.conceptTag,concept_class:crq.conceptClass,concept_category:crq.conceptCategory,concept_id:crq.conceptId,answer:answer,correct:correct?1:0}),correct||crq.attempts>=$scope.numAttempts){$scope.showNextQuestion=!0;var passageId=$state.params.passageId;passageId&&SentenceLocalStorage.storeTempResult(passageId,crq,answer,correct)}}),$state.params.student&&($scope.sessionId=$state.params.student),$scope.finish=function(){var passageId=$state.params.passageId;if(passageId){var tempResults=SentenceLocalStorage.saveResults(passageId);AnalyticsService.trackSentenceWritingSubmission(tempResults,passageId)}else passageId=null;return finalizeService($scope.sessionId,passageId).then(function(){$state.go(".results",{student:$state.params.student})})},$scope.nextQuestion=function(){$scope.showNextQuestion=!1;var crq=$scope.currentRuleQuestion,ncrq=$scope.questions[_.indexOf($scope.questions,crq)+1];return ncrq?($scope.number=$scope.number+1,void($scope.currentRuleQuestion=ncrq)):($scope.number=$scope.number+1,void $scope.finish())},$scope.checkIfAllPfCorrect=function(){return $state.params.pfAllCorrect?$scope.finish():void 0},$scope.checkIfAllPfCorrect(),$state.params.uid)SentenceWritingService.getSentenceWriting($state.params.uid).then(function(sw){$scope.sentenceWriting=sw;var ruleIds=_.pluck(sw.rules,"ruleId"),quantities=_.pluck(sw.rules,"quantity");return retrieveNecessaryRules(ruleIds,quantities)},errorStateChange);else if($state.params.ids){var ids=_.uniq($state.params.ids.split(",")),quantities=_.chain(ids).map(function(){return 3}).value();retrieveNecessaryRules(ids,quantities)}$scope.formatDescription=function(des){if(des){var entries=des.split("."),phrases=[],sentences=[];_.each(entries,function(e){e="<li>"+e+".</li>",-1!==e.indexOf(":")?phrases.push(e):sentences.push(e)});var html="<ul>"+phrases.join("")+"</ul><hr/><ul>"+sentences.join("")+"</ul>";return html}}}]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/sentences/module.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.play.sentences",[require("./../../../services/sentenceWriting.js").name,require("./../../../services/rule.js").name,require("./../../../services/category.js").name,require("./../../../services/analytics.js").name,require("./../../../services/localStorage.js").name,"empirical-angular","ui.router"]).config(require("./config.js")).directive("sentenceWritingConceptOverview",function(){return{restrict:"E",templateUrl:"sentences.concept-overview.html"}}).directive("sentenceWritingSubmitPanel",function(){return{restrict:"E",templateUrl:"sentences.submit-panel.html"}}).controller("ResultsController",require("./results.controller.js")).controller("SentencePlayCtrl",require("./controller.js"))},{"./../../../services/analytics.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/analytics.js","./../../../services/category.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/category.js","./../../../services/localStorage.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/localStorage.js","./../../../services/rule.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/rule.js","./../../../services/sentenceWriting.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/sentenceWriting.js","./config.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/sentences/config.js","./controller.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/sentences/controller.js","./results.controller.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/sentences/results.controller.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/app/play/sentences/results.controller.js":[function(require,module,exports){"use strict";module.exports=function($scope,$state,portholeProxy){var windowProxy=new Porthole.WindowProxy(portholeProxy),postObj={action:"activity_complete"};$state.params.student&&(postObj.id=$state.params.student),windowProxy.post(postObj)},module.exports.$inject=["$scope","$state","portholeProxy"]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/categories.list.js":[function(require,module,exports){"use strict";function categoriesList(){return{restrict:"E",templateUrl:"categories.list.html",controller:"GrammarCmsCtrl"}}module.exports=categoriesList},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/categories.new.js":[function(require,module,exports){"use strict";function categoriesNew(){return{restrict:"E",templateUrl:"categories.new.html",controller:"GrammarCmsCtrl"}}module.exports=categoriesNew},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/category.edit.js":[function(require,module,exports){"use strict";function panel(){return{restrict:"E",scope:{category:"="},templateUrl:"category.edit.html",controller:"CategoryCtrl"}}function controller($scope,cs,rs,$q){$scope.deleteCategory=function(category){return cs.deleteCategory(category).then(function(){console.log("deleting category ",category)})},$scope.editCategory=function(category){console.log(category)},$scope.newRule=function(){$scope.showNewRuleModal=!0},$scope.showDeleteCategory=function(){$scope.showDeleteCategoryModal=!0},$scope.saveRule=function(category,rule){var d=$q.defer();return rs.saveRule(rule).then(function(ruleId){category.rules||(category.rules={}),category.rules[ruleId]=!0,cs.updateCategory(category).then(function(){category.resolvedRules||(category.resolvedRules=[]),category.resolvedRules.push(rule),$scope.category=category,d.resolve()},d.reject)},d.reject),d.promise}}module.exports.panel=panel,module.exports.controller=["$scope","CategoryService","RuleService","$q",controller]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/category.show.js":[function(require,module,exports){"use strict";function categoryShow(){return{restrict:"E",templateUrl:"category.show.html",controller:"GrammarCmsCtrl",scope:{category:"="}}}module.exports=categoryShow},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/cms.controller.js":[function(require,module,exports){"use strict";function cmsController($scope,cs,rs){cs.getCategories().then(function(categories){$scope.categories=categories}),$scope.showRules=function(category){rs.getRules(category.rules).then(function(rules){category.resolvedRules=rules},function(e){category.error=e})},$scope.hideRules=function(category){category.resolvedRules=null},$scope.saveCategory=function(category){return cs.saveCategory(category).then(function(){console.log("Saved",category),category.title=""})},$scope.toggleCategoryModal=function(){$scope.showNewCategoryModal=!0}}module.exports=["$scope","CategoryService","RuleService",cmsController]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/index.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.directives.grammarCMS",[require("./../../services/category.js").name,require("./../../services/rule.js").name]).directive("grammarCmsCategoriesNew",require("./categories.new.js")).directive("grammarCmsCategoriesList",require("./categories.list.js")).directive("grammarCmsCategory",require("./category.show.js")).directive("grammarCmsRule",require("./rule.show.js")).directive("grammarCmsCategoryPanel",require("./category.edit.js").panel).directive("grammarCmsRulePanel",require("./rule.edit.js").panel).directive("grammarCmsRuleQuestion",require("./question.js").show).directive("grammarCmsRuleQuestionPanel",require("./question.js").panel).directive("grammarCmsModalDialog",require("./modal.js").modal).directive("grammarCmsDeleteModalDialog",require("./modal.js").deleteModal).controller("ModalDialogCtrl",require("./modal.js").controller).controller("RuleCtrl",require("./rule.edit.js").controller).controller("CategoryCtrl",require("./category.edit.js").controller).controller("QuestionCtrl",require("./question.js").controller).controller("GrammarCmsCtrl",require("./cms.controller.js"));

},{"./../../services/category.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/category.js","./../../services/rule.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/rule.js","./categories.list.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/categories.list.js","./categories.new.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/categories.new.js","./category.edit.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/category.edit.js","./category.show.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/category.show.js","./cms.controller.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/cms.controller.js","./modal.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/modal.js","./question.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/question.js","./rule.edit.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/rule.edit.js","./rule.show.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/rule.show.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/modal.js":[function(require,module,exports){"use strict";function modal(){return{restrict:"E",scope:{show:"=",action:"="},replace:!0,transclude:!0,templateUrl:"modal.html",controller:"ModalDialogCtrl",link:function(scope){scope.hideModal=function(){scope.show=!1},scope.doAction=function(){scope.action.apply(this,arguments).then(function(){scope.hideModal()})}}}}function deleteModal(){return{restrict:"E",scope:{show:"=",onDelete:"=",item:"="},replace:!0,transclude:!0,templateUrl:"deleteModal.html",link:function(scope){scope.hideModal=function(){scope.show=!1},scope._onDelete=function(){scope.onDelete(scope.item).then(function(){scope.hideModal()},function(error){scope.error=error})}}}}function controller(){}module.exports.modal=modal,module.exports.deleteModal=deleteModal,module.exports.controller=[controller]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/question.js":[function(require,module,exports){"use strict";function show(){return{restrict:"E",templateUrl:"question.show.html"}}function panel(){return{restrict:"E",controller:"QuestionCtrl",templateUrl:"question.edit.html"}}function controller($scope,rqs,rs){$scope.showDeleteRuleQuestion=function(){$scope.showDeleteRuleQuestionModal=!0},$scope.deleteRuleQuestion=function(question){var rule=$scope.rule;return rqs.deleteRuleQuestion(question).then(function(){return rs.removeRuleQuestionFromRule(rule,question)})}}module.exports.show=show,module.exports.panel=panel,module.exports.controller=["$scope","RuleQuestionService","RuleService",controller]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/rule.edit.js":[function(require,module,exports){"use strict";function controller($scope,rs,rqs){$scope.deleteRule=function(){var category=$scope.category,rule=$scope.rule;return rs.deleteRule(category,rule).then(function(){$scope.rule=null},function(error){$scope.rule.error=error})},$scope.showDeleteRule=function(){$scope.showDeleteRuleModal=!0},$scope.editRule=function(rule){console.log("editing rule "+rule)},$scope.showRuleQuestionModal=function(){$scope.showNewRuleQuestionModal=!0},$scope.saveRuleQuestion=function(rule,question){return rqs.saveRuleQuestion(question).then(function(questionId){return rule.ruleQuestions||(rule.ruleQuestions={}),console.log(questionId),rule.ruleQuestions[questionId]=!0,rs.updateRule(rule)})},$scope.addAnswerToBody=function(question){question&&question.body&&question.body.push&&question.tempB&&(question.body.push(question.tempB),question.tempB=null)},$scope.question={body:[]}}function panel(){return{restrict:"E",controller:"RuleCtrl",templateUrl:"rule.edit.html"}}module.exports.controller=["$scope","RuleService","RuleQuestionService",controller],module.exports.panel=panel},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarCMS/rule.show.js":[function(require,module,exports){"use strict";function ruleShow(){return{restrict:"E",templateUrl:"rule.show.html",controller:"GrammarCmsCtrl"}}module.exports=ruleShow},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarElements/ruleQuestion/controller.js":[function(require,module,exports){"use strict";module.exports=function($scope,_,$timeout){function removeDelimeters(b){if("string"!=typeof b)throw new Error("Input must be type string removeDelimeters");return b.replace(delim.open,"").replace(delim.close,"")}function compareEntireAnswerToBody(answer){return function(b){var cleaned=removeDelimeters(b);return answer===cleaned}}function getCorrectString(b){var answers=_.chain(b).map(removeDelimeters).value();return"<ul><li>"+answers.join("</li><li>")+"</ul>"}function compareGrammarElementToBody(answer){return function(b){if(!answer)return!1;var reg=new RegExp(delim.open+"(.*)"+delim.close,"g"),results=reg.exec(b),grammarElements=_.rest(results);return _.every(grammarElements,function(element){var r=new RegExp("(^|\\W{1,1})"+element+"(\\W{1,1}|$)","g");return-1!==answer.search(r)})}}function ensureLengthIsProper(answer){var threshold=.8;return function(body){var b=body.replace(delim.open,"").replace(delim.close,"");return answer.length/b.length>=threshold}}function setMessage(msg){$scope.ruleQuestion.message=msg}var strictTypingMode=!1,delim={open:"{",close:"}"};$scope.answerText={"default":"Check Work",notLongEnough:"<b>Try again!</b>Your answer is not long enough.",tryAgain:"<b>Try Again!</b> Unfortunately, that answer is incorrect.",tryAgainButton:"Recheck Work",typingErrorNonStrict:"You are correct, but you have some typing errors. You may correct them or continue.",typingErrorStrict:"You are correct, but have some typing errors. Please fix them.",incorrectWithAnswer:function(answer){return"<b>Incorrect.</b> Correct Answer: "+answer},correct:"<b>Well done!</b> That's the correct answer.",noAnswer:"You must enter a sentence for us to check."},$scope.$watch("ruleQuestion.$id",function(){$scope.checkAnswerText=$scope.answerText["default"],$scope.ruleQuestionClass="default",$scope.showCheckAnswerButton=!0,$timeout.cancel($scope.shortAnswerPromise)}),$scope.checkAnswer=function(){var rq=$scope.ruleQuestion,answer=rq.response,correct=!1;if($timeout.cancel($scope.shortAnswerPromise),!answer)return setMessage($scope.answerText.noAnswer),$scope.ruleQuestionClass="try_again",void($scope.shortAnswerPromise=$timeout(function(){setMessage(""),$scope.ruleQuestionClass="default"},3e3));var exactMatch=_.any(rq.body,compareEntireAnswerToBody(answer));if(exactMatch)setMessage($scope.answerText.correct),$scope.ruleQuestionClass="correct",correct=!0;else{var grammarMatch=_.any(rq.body,compareGrammarElementToBody(answer)),answerIsAdequateLength=_.every(rq.body,ensureLengthIsProper(answer));answerIsAdequateLength||(setMessage($scope.answerText.notLongEnough),$scope.ruleQuestionClass="try_again"),grammarMatch&&!strictTypingMode?(setMessage($scope.answerText.typingErrorNonStrict),$scope.ruleQuestionClass="correct",correct=!0):grammarMatch?($scope.ruleQuestionClass="try_again",setMessage($scope.answerText.typingErrorStrict)):($scope.ruleQuestionClass="try_again",setMessage($scope.answerText.tryAgain))}rq.attempts?rq.attempts++:rq.attempts=1,correct||rq.attempts>=2?($scope.$emit("answerRuleQuestion",rq,answer,correct),$scope.showCheckAnswerButton=!1,correct||(setMessage($scope.answerText.incorrectWithAnswer(getCorrectString(rq.body))),$scope.ruleQuestionClass="incorrect")):correct||($scope.$emit("answerRuleQuestionIncorrect",rq),$scope.checkAnswerText=$scope.answerText.tryAgainButton)},$scope.capturePasteEvent=function(event){event.preventDefault()}},module.exports.$inject=["$scope","_","$timeout"]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarElements/ruleQuestion/directive.js":[function(require,module,exports){"use strict";module.exports=function(){return{restrict:"E",transclude:!0,scope:{ruleQuestion:"="},templateUrl:"ruleQuestion.html",controller:"GrammarRuleQuestionCtrl"}}},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarElements/ruleQuestion/filters.js":[function(require,module,exports){"use strict";module.exports.formatPrompt=function(){return function(input){return input}}},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarElements/ruleQuestion/index.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.directives.ruleQuestion",[]).directive("grammarRuleQuestion",require("./directive.js")).filter("formatPrompt",require("./filters.js").formatPrompt).controller("GrammarRuleQuestionCtrl",require("./controller.js"))},{"./controller.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarElements/ruleQuestion/controller.js","./directive.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarElements/ruleQuestion/directive.js","./filters.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/grammarElements/ruleQuestion/filters.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/index.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.directives",[]).directive("activityProgressBar",require("./progressBar.js").directive).controller("ProgressBarCtrl",require("./progressBar.js").controller)},{"./progressBar.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/progressBar.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/directives/progressBar.js":[function(require,module,exports){"use strict";module.exports.directive=function(){return{restrict:"E",scope:{title:"=",max:"=",current:"="},controller:"ProgressBarCtrl",templateUrl:"progress-bar.html"}},module.exports.controller=function($scope){function calculate(){$scope.progressString=String($scope.current)+" of "+String($scope.max),$scope.progressBarPercentage={width:String($scope.current/$scope.max*100)+"%"}}$scope.$watch("max",calculate),$scope.$watch("current",calculate),calculate()},module.exports.controller.$inject=["$scope"]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/filters/index.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.filters",[]).filter("trustedHtml",require("./trustedHtml.js"))},{"./trustedHtml.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/filters/trustedHtml.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/filters/trustedHtml.js":[function(require,module,exports){"use strict";module.exports=function($sce){return function(input){return $sce.trustAsHtml(input)}},module.exports.$inject=["$sce"]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/analytics.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.services.analytics",["angulartics"]).factory("AnalyticsService",["$q","$analytics",function($q,$analytics){function trackSentenceWritingSubmission(results,passageId){null===results&&(results={});var event="Sentence Writing Submitted",c=_.pluck(results,"correct"),attrs={uid:passageId,answers:_.pluck(results,"answer"),correct:c,conceptCategory:_.pluck(results,"conceptClass"),total:results.length,numCorrect:c.length};$analytics.eventTrack(event,attrs)}return{trackSentenceWritingSubmission:trackSentenceWritingSubmission}}])},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/auth/config.js":[function(require,module,exports){"use strict";module.exports=["$httpProvider","$stateProvider",function($httpProvider,$stateProvider){$httpProvider.interceptors.push(require("./oauth_interceptor.js")),$stateProvider.state("access_token",{url:"/access_token={accessToken}&token_type={tokenType}&expires_in={expiresIn}",template:"",controller:["$stateParams","AccessToken","$location","$state","Storage",function($stateParams,AccessToken,$location,$state,Storage){var hashStr=["access_token="+$stateParams.accessToken,"token_type="+$stateParams.tokenType,"expires_in="+$stateParams.expiresIn].join("&");AccessToken.setTokenFromString(hashStr);var postAuthenticationRedirect=Storage["delete"]("postAuthenticationRedirect");$state.go(postAuthenticationRedirect.stateName,postAuthenticationRedirect.stateParams)}]})}]},{"./oauth_interceptor.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/auth/oauth_interceptor.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/auth/firebase.js":[function(require,module,exports){"use strict";var R=require("ramda");module.exports=function($firebaseAuth,firebaseApp,firebaseUrl,empiricalBaseURL,$http,localStorageService){function fetchToken(){return $http.post(firebaseTokenUrl).then(function(response){return response.data.token},function(response){console.log("an error occurred while fetching the firebase token: ",response)})}function storeToken(token){localStorageService.set("token",token)}function resetToken(){console.log("resetting the token"),storeToken(null)}function getCached(prop){return localStorageService.get(prop)}function firebaseAuthWithToken(token){return authObj.$authWithCustomToken(token).then(R.identity,handleErrors)}function authenticate(){offAuth&&(console.log("disabling auth callback"),offAuth());var ref=new Firebase(firebaseUrl);return authObj=$firebaseAuth(ref),offAuth=authObj.$onAuth(reAuthIfLoggedOut),fetchAndAuthWithToken(getCached("token"))}var authObj,offAuth,firebaseTokenUrl=empiricalBaseURL.replace(/\/?$/,"/firebase_tokens")+"?app="+firebaseApp,maybeFetchToken=R.ifElse(R.not,R.pipeP(fetchToken,R.tap(storeToken)),R.identity),fetchAndAuthWithToken=R.pipeP(maybeFetchToken,firebaseAuthWithToken),resetAndFetch=R.pipeP(resetToken,fetchAndAuthWithToken),handleErrors=R.cond([R.propEq("code","EXPIRED_TOKEN"),resetAndFetch],[R.propEq("code","INVALID_TOKEN"),resetAndFetch],[R.T,R.identity]),reAuthIfLoggedOut=R.ifElse(R.not,fetchAndAuthWithToken,R.identity);return{authenticate:authenticate}},module.exports.$inject=["$firebaseAuth","firebaseApp","firebaseUrl","empiricalBaseURL","$http","localStorageService"]},{ramda:"/home/will/Clients/Quill/Quill-Grammar/node_modules/ramda/dist/ramda.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/auth/index.js":[function(require,module,exports){"use strict";module.exports=angular.module("services.auth",["firebase","oauth","ui.router","LocalStorageModule",require("../../../../.tmp/config").name]).config(require("./config.js")).factory("QuillFirebaseAuthService",require("./firebase.js")).factory("QuillOAuthService",require("./oauth.js"))},{"../../../../.tmp/config":"/home/will/Clients/Quill/Quill-Grammar/.tmp/config.js","./config.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/auth/config.js","./firebase.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/auth/firebase.js","./oauth.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/auth/oauth.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/auth/oauth.js":[function(require,module,exports){"use strict";module.exports=function(empiricalBaseURL,oauthClientId,AccessToken,Endpoint,$state,Storage,$rootScope){function isAuthenticated(){return AccessToken.set(),!!AccessToken.get()}function authenticate(currentState,currentStateParams){Storage.set("postAuthenticationRedirect",{stateName:currentState.name,stateParams:currentStateParams});var redirectUri=$state.href("index",{},{absolute:!0}),endpointParams={authorizePath:"oauth/authorize",site:empiricalBaseURL.replace(/api\/v1\/?/,""),clientId:oauthClientId,redirectUri:redirectUri,responseType:"token"};Endpoint.redirect(endpointParams)}function expireToken(){AccessToken.destroy()}function watchForExpiration(currentState,currentStateParams){$rootScope.$on("oauth:expired",function(){authenticate(currentState,currentStateParams)})}return{isAuthenticated:isAuthenticated,authenticate:authenticate,expire:expireToken,watchForExpiration:watchForExpiration}},module.exports.$inject=["empiricalBaseURL","oauthClientId","AccessToken","Endpoint","$state","Storage","$rootScope"]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/auth/oauth_interceptor.js":[function(require,module,exports){"use strict";module.exports=function($q,AccessToken){return{request:function(config){AccessToken.set();var token=AccessToken.get();return token?config.headers.Authorization="Bearer "+token.access_token:delete config.headers.Authorization,config}}},module.exports.$inject=["$q","AccessToken"]},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/calculatePercentage.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.services.calculatePercentage",[]).factory("calculatePercentageService",function(){var calculatePercentage=function(conceptTagResults,pfResults){var swNumCorrect,swNumTotal;conceptTagResults.length?(swNumCorrect=_.reduce(conceptTagResults,function(memo,ctr){return memo+ctr.correct},0),swNumTotal=conceptTagResults.length):(swNumCorrect=0,swNumTotal=0);var pfNumCorrect,pfNumTotal;pfResults.length?(pfNumCorrect=_.reduce(pfResults,function(memo,r){return memo+r.correct},0),pfNumTotal=_.reduce(pfResults,function(memo,r){return memo+r.total},0)):(pfNumCorrect=0,pfNumTotal=0);var numCorrect,numTotal;numCorrect=swNumCorrect+pfNumCorrect,numTotal=swNumTotal+pfNumTotal;var percentage;return percentage=numTotal?numCorrect/numTotal:0};return calculatePercentage})},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/category.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.services.category",[require("./crud.js").name]).factory("CategoryService",["CrudService","_",function(CrudService,_){var crud=new CrudService("categories",["title","rules"],"cms");return this.saveCategory=function(category){return crud.save(category)},this.deleteCategory=function(category){return crud.del(category)},this.getCategories=function(){return crud.all()},this.updateCategory=function(category){return crud.update(category)},this.removeRuleFromCategory=function(category,rule){if(!category||!category.rules)throw new Error("Category does not have any rules to remove");return _.each(category.rules,function(r,key){key===rule.$id&&(category.rules[key]=null)}),crud.update(category)},this}])},{"./crud.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/crud.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/classification.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.services.classification",[require("./crud.js").name]).factory("ClassificationService",["CrudService","$q",function(CrudService,$q){var crud=new CrudService("classifications",[],"cms"),cfs=this;return cfs.saveClassification=function(classification){return crud.save(classification)},cfs.deleteClassification=function(classification){return crud.del(classification)},cfs.getClassification=function(classificationId){return crud.get(classificationId)},cfs.getClassificationIdByString=function(classificationString){var d=$q.defer();return crud.all().then(function(classifications){angular.forEach(classifications,function(cl){var c=cl.$value;c.toLowerCase()===classificationString.toLowerCase()&&d.resolve(cl.$id)}),cfs.saveClassification(classificationString).then(function(id){console.log(id),d.resolve(id)},d.reject)},d.reject),d.promise},cfs}])},{"./crud.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/crud.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/crud.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.services.crud",["firebase","underscore",require("../../../.tmp/config").name]).factory("CrudService",["firebaseUrl","$firebase","$q","_",function(firebaseUrl,$firebase,$q,_){function crud(entity,properties,prefix){function getRef(){return baseRef}function sanitize(item){return properties&&_.isObject(item)?_.pick(item,function(value,key){return"$"===key[0]||_.contains(properties,key)}):item}function isValid(item){return _.has(item,"$value")?!_.isUndefined(item.$value)&&null!==item.$value:!0}function save(item){var d=$q.defer(),entityItem=sanitize(item);return baseRef.$push(entityItem).then(function(ref){d.resolve(ref.key())},function(error){d.reject(error)}),d.promise}function del(item){var d=$q.defer();if(!item||!item.$id)throw new Error("Item doesn't have an $id property");return baseRef.$remove(item.$id).then(function(ref){d.resolve(ref.key())},function(error){d.reject(error)}),d.promise}function all(){var d=$q.defer(),a=baseRef.$asArray();return a.$loaded().then(function(){d.resolve(a)},function(error){d.reject(error)}),d.promise}function get(entityId){var d=$q.defer(),entityRef=new Firebase(baseRoute+"/"+entityId),entity=$firebase(entityRef).$asObject();return entity.$loaded().then(function(entityData){isValid(entityData)?d.resolve(entityData):(console.error(entityId),console.error(entityData),d.reject(new Error("Entity did not meet the properties requirement")))},function(error){d.reject(error)}),d.promise}function update(item){var d=$q.defer();return baseCollection.$loaded().then(function(){var index=item.$id;baseCollection[index]=sanitize(item),baseCollection.$save(index).then(function(ref){console.log(ref.key()),d.resolve(ref.key())},function(error){console.log(error),d.reject(error)})}),d.promise}function saveWithCustomId(item){if(!item.$id)throw new Error("No id provided");var id=String(item.$id);delete item.$id,item=sanitize(item);var fb=$firebase(new Firebase(baseRoute+"/"+id));return fb.$set(item)}if(!entity||""===entity)throw new Error("Firebase Entity MUST be defined");if(!properties)throw new Error("Please define the properties for your entity "+entity);"/"!==firebaseUrl[firebaseUrl.length-1]&&(firebaseUrl+="/");var baseUrl=String(firebaseUrl);prefix&&(baseUrl=baseUrl+prefix+"/");var baseRoute=baseUrl+entity,baseRef=$firebase(new Firebase(baseRoute)),baseCollection=baseRef.$asObject();return{save:save,saveWithCustomId:saveWithCustomId,del:del,all:all,get:get,update:update,getRef:getRef}}return crud}])},{"../../../.tmp/config":"/home/will/Clients/Quill/Quill-Grammar/.tmp/config.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/finalize.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.services.finalize",[require("empirical-angular").name,require("../../../.tmp/config").name,require("./calculatePercentage.js").name,require("./localStorage.js").name]).factory("finalizeService",["$q","ConceptTagResult","ActivitySession","calculatePercentageService","localStorageService",function($q,ConceptTagResult,ActivitySession,calculatePercentageService,localStorageService){function finalize(sessionId,passageId){var pfResults;return pfResults=passageId?localStorageService.get("pf-"+passageId):[],sessionId?ConceptTagResult.findAsJsonByActivitySessionId(sessionId).then(function(list){return ActivitySession.finish(sessionId,{percentage:calculatePercentageService(list,pfResults)})}).then(function(){return ConceptTagResult.removeBySessionId(sessionId)})["catch"](function(e){throw console.log("An error occurred while saving results to the LMS",e),e}):$q.when()}return finalize}])},{"../../../.tmp/config":"/home/will/Clients/Quill/Quill-Grammar/.tmp/config.js","./calculatePercentage.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/calculatePercentage.js","./localStorage.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/localStorage.js","empirical-angular":"/home/will/Clients/Quill/Quill-Grammar/node_modules/empirical-angular/index.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/flag.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.services.flags",[require("./crud.js").name]).factory("FlagService",["CrudService",function(CrudService){var crud=new CrudService("flags",[],"cms"),fs=this;return fs.saveFlag=function(flag){return crud.save(flag)},fs.deleteFlag=function(flag){return crud.del(flag)},fs.getFlag=function(flagId){return crud.get(flagId)},fs.getFlags=function(){return crud.all()},fs}])},{"./crud.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/crud.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/indexBy.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.services.index",[require("./crud.js").name]).factory("IndexService",["firebaseUrl","$firebase",function(firebaseUrl,$firebase){function index(indexName){function getEntries(){return $firebase(new Firebase(firebaseUrl+indexName)).$asObject()}function getEntry(e){return $firebase(new Firebase(firebaseUrl+indexName+"/"+e)).$asObject()}function addElementToEntry(entry,element){return getEntry(entry).$loaded().then(function(list){return list[element]=!0,list.$save()})}function removeElementFromEntry(entry,element){return getEntry(entry).$loaded().then(function(list){return delete list[element],list.$save()})}function removeEntry(entry){return getEntries().$loaded().then(function(entries){return entries[entry]=null,entries.$save()})}function lookUpElementsForEntry(entry){return getEntry(entry)}if("/"!==firebaseUrl[firebaseUrl.length-1]&&(firebaseUrl+="/"),firebaseUrl+="indices/",!indexName||""===indexName)throw new Error("Firebase indexName MUST be defined");return{addElementToEntry:addElementToEntry,removeElementFromEntry:removeElementFromEntry,removeEntry:removeEntry,lookUpElementsForEntry:lookUpElementsForEntry}}return index}])},{"./crud.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/crud.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/instruction.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.services.instruction",[require("./crud.js").name]).factory("InstructionService",["CrudService",function(CrudService){var crud=new CrudService("instructions",[],"cms");return this.saveInstruction=function(instruction){return crud.save(instruction)},this.deleteInstruction=function(instruction){return crud.del(instruction)},this.getInstruction=function(instructionId){return crud.get(instructionId)},this}])},{"./crud.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/crud.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/localStorage.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.services.localStorage",["LocalStorageModule"]).factory("SentenceLocalStorage",["$q","localStorageService",function($q,localStorageService){function storeTempResult(passageId,crq,answer,correct){var key="sw-temp-"+passageId,rs=localStorageService.get(key);rs||(rs=[]),rs.push({conceptClass:crq.conceptCategory,correct:correct,answer:answer}),localStorageService.set(key,rs)}function saveLocalResults(passageId){if(passageId){var tempKey="sw-temp-"+passageId,trs=localStorageService.get(tempKey),rs=_.chain(trs).groupBy("conceptClass").map(function(entries,cc){return{conceptClass:cc,total:entries.length,correct:_.filter(entries,function(v){return v.correct}).length}}).value();return localStorageService.set("sw-"+passageId,rs),localStorageService.remove(tempKey),trs}}return{storeTempResult:storeTempResult,saveResults:saveLocalResults}}])},{}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/proofreading.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.services.proofreading",[require("./crud.js").name]).factory("ProofreadingService",["CrudService","_","uuid4",function(CrudService,_,uuid4){var crud=new CrudService("passageProofreadings",["flagId","categoryId","instructions","passage","title","description"],"activities"),ps=this;return this.saveProofreading=function(proofreading){return crud.save(proofreading)},this.deleteProofreading=function(proofreading){return crud.del(proofreading)},this.getProofreading=function(proofreadingId){return crud.get(proofreadingId)},this.getAllProofreadings=function(){return crud.all()},this.htmlMatches=function(text){return text?text.match(/<\s*br\s*?\/>/g):null},this.prepareProofreading=function(pf,$scope){$scope.passageQuestions={},pf.replace(/{\+([^-]+)-([^|]+)\|([^}]+)}/g,function(key,plus,minus,ruleNumber){var genKey=uuid4.generate();$scope.passageQuestions[genKey]={plus:plus,minus:minus,ruleNumber:ruleNumber},pf=pf.replace(key,genKey)});var prepared=_.chain(pf.split(/\s/)).filter(function(n){return""!==n}).map(function(w){var matches=ps.htmlMatches(w);return matches?(_.each(matches,function(match){w!==match&&(w=w.replace(new RegExp(match,"g")," "+match+" "))}),w=w.trim(),w.split(/\s/)):w}).flatten().map(function(w){return _.each($scope.passageQuestions,function(v,key){w!==key&&-1!==w.indexOf(key)&&(w=w.split(key).join(" "+key).split(/\s/))}),w}).flatten().map(function(w){var passageQuestion=$scope.passageQuestions[w];if(passageQuestion){var c=_.clone(passageQuestion);return c.text=c.minus,c.responseText=c.text,c}return{text:w,responseText:w}}).map(function(w){return w.text=w.text.trim(),w.responseText=w.responseText.trim(),w}).filter(function(w){return""!==w.text}).value();return prepared},this}])},{"./crud.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/crud.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/rule.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.services.rule",[require("./crud.js").name,require("./ruleQuestion.js").name,require("./classification.js").name]).factory("RuleService",["CrudService","CategoryService","RuleQuestionService","$q","ClassificationService","_",function(CrudService,CategoryService,RuleQuestionService,$q,ClassificationService,_){var crud=new CrudService("rules",["title","description","ruleNumber","classification","ruleQuestions"],"cms");return this.updateRule=function(rule){return crud.update(rule)},this.saveRule=function(rule){function getClassification(rule){return ClassificationService.getClassificationIdByString(rule.classification).then(function(cid){return rule.classification=cid,rule},function(error){return error})}function addRuleNumber(rule){var ruleNumber=new CrudService("ruleNumberCounter",[],"cms").getRef();ruleNumber.$transaction(function(currentRuleNumber){if(!currentRuleNumber)return 1;if(!(0>currentRuleNumber))return currentRuleNumber+1}).then(function(snapshot){null===snapshot?d.reject(new Error("current rule number error: snapshot null")):(rule.ruleNumber=snapshot.val(),d.resolve(rule))},function(error){d.reject(error)});var d=$q.defer();return d.promise}return getClassification(rule).then(addRuleNumber).then(crud.save)},this.deleteRule=function(category,rule){return crud.del(rule).then(function(){return CategoryService.removeRuleFromCategory(category,rule)})},this.getAllRules=function(){return crud.all()},this.removeRuleQuestionFromRule=function(rule,question){if(!rule||!rule.ruleQuestions)throw new Error("rule does not have any ruleQuestions to remove");return _.each(rule.ruleQuestions,function(r,key){key===question.$id&&(rule.ruleQuestions[key]=null)}),crud.update(rule)},this.getRules=function(ruleIds){function getRuleQuestionsForRules(rules){var rqp=$q.defer(),ruleQuestionPromises=[];return _.each(rules,function(rule){ruleQuestionPromises.push(RuleQuestionService.getRuleQuestions(rule.ruleQuestions))}),$q.all(ruleQuestionPromises).then(function(ruleQuestions){_.each(rules,function(rule,index){rule.resolvedRuleQuestions=ruleQuestions[index]}),rqp.resolve(rules)},function(errors){rqp.reject(errors)}),rqp.promise}function getClassificationForRules(rules){var cfr=$q.defer(),cls=[];return _.each(rules,function(rule){cls.push(ClassificationService.getClassification(rule.classification))}),$q.all(cls).then(function(classifications){_.each(rules,function(rule,index){
rule&&classifications[index]&&(rule.resolvedClassification=classifications[index])}),cfr.resolve(rules)},function(error){console.log(error),cfr.resolve(rules)}),cfr.promise}var d=$q.defer(),promises=_.map(ruleIds,function(id,key){return _.isArray(ruleIds)||(id=key),crud.get(id)});return $q.all(promises).then(getRuleQuestionsForRules).then(getClassificationForRules).then(function(rules){d.resolve(rules)},function(error){d.reject(error)}),d.promise},this}])},{"./classification.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/classification.js","./crud.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/crud.js","./ruleQuestion.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/ruleQuestion.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/ruleQuestion.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.services.ruleQuestion",[require("./crud.js").name,require("./instruction.js").name]).factory("RuleQuestionService",["CrudService","InstructionService","$q","_",function(CrudService,InstructionService,$q,_){function getInstructionForRuleQuestion(ruleQuestions){var insp=$q.defer(),ins=[];return _.each(ruleQuestions,function(rq){ins.push(InstructionService.getInstruction(rq.instructions))}),$q.all(ins).then(function(instructions){_.each(ruleQuestions,function(rq,index){rq.resolvedInstructions=instructions[index].$value}),insp.resolve(ruleQuestions)},function(errors){insp.reject(errors)}),insp.promise}var crud=new CrudService("ruleQuestions",["body","hint","instructions","prompt","conceptTag","conceptClass","conceptCategory"],"cms");return this.saveRuleQuestion=function(ruleQuestion){return crud.save(ruleQuestion)},this.deleteRuleQuestion=function(ruleQuestion){return crud.del(ruleQuestion)},this._getAllRuleQuestionsWithInstructions=function(){return crud.all().then(getInstructionForRuleQuestion)},this.getRuleQuestions=function(ruleQuestionIds){var d=$q.defer(),promises=_.map(ruleQuestionIds,function(id,key){return _.isArray(ruleQuestionIds)||(id=key),crud.get(id)});return $q.all(promises).then(getInstructionForRuleQuestion).then(function(ruleQuestions){d.resolve(ruleQuestions)},function(error){d.reject(error)}),d.promise},this}])},{"./crud.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/crud.js","./instruction.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/instruction.js"}],"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/sentenceWriting.js":[function(require,module,exports){"use strict";module.exports=angular.module("quill-grammar.services.sentenceWriting",[require("./crud.js").name,require("./indexBy.js").name]).factory("SentenceWritingService",["CrudService","_","IndexService",function(CrudService,_,IndexService){function checkAndFormatSentenceWritingActivity(swa){var valid=_.every(["category","flag"],function(k){return swa[k]&&swa[k].$id?(swa[k+"Id"]=swa[k].$id,!0):!1});if(!valid)throw new Error("SentenceWritingActivity did not contain category or flag");return swa.rules=_.map(swa.rules,function(r){return{ruleId:r.$id,quantity:r.quantity}}),swa}var crud=new CrudService("sentenceWritings",["flagId","categoryId","rules","title","description"],"activities"),catIndex=new IndexService("sentenceWritingsByCategory");return this.saveSentenceWriting=function(sentenceWritingActivity){var swa=checkAndFormatSentenceWritingActivity(sentenceWritingActivity);return crud.save(swa).then(function(ref){return catIndex.addElementToEntry(swa.categoryId,ref)})},this.saveSentenceWritingWithId=function(sentenceWritingActivity){var swa=checkAndFormatSentenceWritingActivity(sentenceWritingActivity),id=String(swa.$id);return crud.saveWithCustomId(swa).then(function(){return catIndex.addElementToEntry(swa.categoryId,id)})},this.updateSentenceWriting=function(sentenceWritingActivity){var swa=checkAndFormatSentenceWritingActivity(sentenceWritingActivity);if(!swa.oldCategoryId)throw new Error("Old Category Id not defined");return catIndex.removeElementFromEntry(swa.oldCategoryId,swa.$id).then(function(){return crud.update(swa).then(function(){return catIndex.addElementToEntry(swa.categoryId,swa.$id)})})},this.deleteSentenceWriting=function(sentenceWritingActivity){return crud.del(sentenceWritingActivity)},this.getSentenceWriting=function(sentenceWritingActivityId){return crud.get(sentenceWritingActivityId)},this.getAllSentenceWritings=function(){return crud.all()},this}])},{"./crud.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/crud.js","./indexBy.js":"/home/will/Clients/Quill/Quill-Grammar/src/scripts/services/indexBy.js"}]},{},["./src/scripts/app/app.module.js"]);